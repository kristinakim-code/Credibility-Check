{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "RX_J4FO1UM9V"
      },
      "source": [
        "## Import `tf` Library"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 1,
      "metadata": {
        "id": "FYWwfshkN4z-"
      },
      "outputs": [],
      "source": [
        "import tensorflow as tf\n",
        "from tensorflow import keras\n",
        "from tensorflow.keras.layers import Input, Embedding, Dense, Concatenate, Flatten\n",
        "from tensorflow.keras.models import Model\n",
        "from tensorflow.keras.preprocessing.text import Tokenizer\n",
        "from tensorflow.keras.preprocessing.sequence import pad_sequences\n",
        "import numpy as np\n",
        "import pandas as pd"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "!pip install tensorflow_addons"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "usrzqkR2JxmS",
        "outputId": "52b33475-ff77-4f3e-a7ac-e8b5e9a707bc"
      },
      "execution_count": 2,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Requirement already satisfied: tensorflow_addons in /usr/local/lib/python3.11/dist-packages (0.23.0)\n",
            "Requirement already satisfied: packaging in /usr/local/lib/python3.11/dist-packages (from tensorflow_addons) (24.2)\n",
            "Requirement already satisfied: typeguard<3.0.0,>=2.7 in /usr/local/lib/python3.11/dist-packages (from tensorflow_addons) (2.13.3)\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "vZWECH6nUPU2"
      },
      "source": [
        "## Define Model"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "KBRX6KmamZps"
      },
      "source": [
        "$$\n",
        "\\begin{matrix}\n",
        "X_1 \\rightarrow N_1(X_1) & & \\\\\n",
        "  & \\searrow & \\\\\n",
        "  &          & \\oplus & \\rightarrow & N_3 \\bigg( \\underbrace{N_1(E(X_1))}_\\text{text}, \\underbrace{N_2(X_2)}_\\text{func rating} \\bigg) \\\\\n",
        "  & \\nearrow & \\\\\n",
        "X_2 \\rightarrow N_2(X_2) & & \\\\\n",
        "\\end{matrix}\n",
        "$$"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "cijuTSKBmZps"
      },
      "source": [
        "There are two input channels for the neural network model:\n",
        "- The input channel number 1 takes $X_1$ as input argument, and is fed into an embedding layer, $E(X_1)$. The output is then fitted using a neural network, $N_1(E(X_1))$.\n",
        "- The input channel number 2 takes a single numerical input, $X_2$, and is fed into a shallow neural network, $N_2(X_2)$.\n",
        "- The ouputs of both neural network is concatenated into a latent layer, $l = \\oplus(N_1(E(X_1)), N_2(X)_2)$, which then is fed into another neural network, $N_3(l)$, for further learning."
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "def focal_loss(alpha=0.75, gamma=2.0):\n",
        "    \"\"\"\n",
        "    Computes focal loss to address class imbalance.\n",
        "\n",
        "    Args:\n",
        "    alpha (float): Balancing factor for the minority class.\n",
        "    gamma (float): Modulates loss contribution for hard-to-classify examples.\n",
        "\n",
        "    Returns:\n",
        "    loss function for model compilation.\n",
        "    \"\"\"\n",
        "    def loss(y_true, y_pred):\n",
        "        epsilon = tf.keras.backend.epsilon()  # Small constant to avoid log(0)\n",
        "        y_pred = tf.clip_by_value(y_pred, epsilon, 1.0 - epsilon)  # Ensure valid probability range\n",
        "\n",
        "        cross_entropy = -y_true * tf.math.log(y_pred)  # Compute standard cross-entropy\n",
        "        weight = alpha * tf.pow((1 - y_pred), gamma)  # Apply focal loss weighting\n",
        "\n",
        "        return tf.reduce_mean(weight * cross_entropy)  # Compute the final loss\n",
        "\n",
        "    return loss"
      ],
      "metadata": {
        "id": "FdvkAvSjLZwg"
      },
      "execution_count": 16,
      "outputs": []
    },
    {
      "cell_type": "code",
      "execution_count": 2,
      "metadata": {
        "id": "dSTMr2Q3OyiD"
      },
      "outputs": [],
      "source": [
        "from tensorflow.keras.models import Model\n",
        "from tensorflow.keras.layers import Input, Embedding, Dense, Concatenate, Flatten, Dropout, BatchNormalization\n",
        "from tensorflow.keras.callbacks import ReduceLROnPlateau\n",
        "from tensorflow.keras.regularizers import l2\n",
        "\n",
        "# Define function to create the neural network model\n",
        "def create_nn_model(vocab_size: int, embedding_dim: int, max_length: int, num_of_dense: int, output_dim: int) -> Model:\n",
        "    \"\"\"\n",
        "    Creates a neural network model that processes user prompts using an embedding layer,\n",
        "    concatenates it with function ratings, and passes through dense layers.\n",
        "\n",
        "    Args:\n",
        "        vocab_size (int): Size of the vocabulary for embedding.\n",
        "        embedding_dim (int): Dimensionality of the embedding layer.\n",
        "        max_length (int): Maximum length of input sequences.\n",
        "        num_of_dense (int): Number of dense layers before concatenation.\n",
        "\n",
        "    Returns:\n",
        "        Model: A compiled TensorFlow model.\n",
        "    \"\"\"\n",
        "    # Text input (user prompt)\n",
        "    text_input = Input(shape=(max_length,), name=\"text_input\")\n",
        "    embedding = Embedding(input_dim=vocab_size, output_dim=embedding_dim, input_length=max_length)(text_input)\n",
        "    flatten = Flatten()(embedding)\n",
        "\n",
        "    # Dense layers for text input\n",
        "    num_neurons = 2**10  # Start with 1024 neurons\n",
        "    x = flatten\n",
        "    for _ in range(num_of_dense):\n",
        "        num_neurons = max(1, int(num_neurons / 2))  # Ensure integer neurons, minimum of 1\n",
        "        x = Dense(num_neurons, activation='relu', kernel_regularizer=l2(0.05))(x)  # L2 Regularization\n",
        "        x = BatchNormalization()(x)  # Normalize activations\n",
        "        x = Dropout(0.3)(x)  # Drop 30% of neurons to prevent overfitting\n",
        "\n",
        "    # Numeric input (func_rating)\n",
        "    func_rating_input = Input(shape=(1,), name=\"func_rating_input\")\n",
        "    y = Dense(32, activation='relu')(func_rating_input)\n",
        "\n",
        "    # Concatenate both paths\n",
        "    concatenated = Concatenate()([x, y])\n",
        "    # output = Dense(1, activation='linear', name=\"output\")(concatenated)\n",
        "    output = Dense(output_dim, activation='softmax', name=\"output\")(concatenated)\n",
        "\n",
        "    # Define and compile the model\n",
        "    model = Model(inputs=[text_input, func_rating_input], outputs=output)\n",
        "\n",
        "    # Set up learning rate scheduler\n",
        "    reduce_lr = ReduceLROnPlateau(monitor='val_loss', factor=0.5, patience=5, verbose=1)\n",
        "\n",
        "    # Define focal loss\n",
        "    # focal_loss = tfa.losses.SigmoidFocalCrossEntropy(from_logits = True, alpha=0.75, gamma=2.0)\n",
        "\n",
        "    # Compile model with focal loss\n",
        "    model.compile(optimizer='adam', loss=focal_loss(alpha=0.9, gamma=2.0), metrics=['accuracy'])\n",
        "\n",
        "    # Compile\n",
        "    # model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])\n",
        "\n",
        "    return model"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "H9k9nkCxUQhg"
      },
      "source": [
        "## Prep Data"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 3,
      "metadata": {
        "id": "GYyeXTbMOz3A"
      },
      "outputs": [],
      "source": [
        "# Generate a larger sample dataset with 20 rows\n",
        "data = {\n",
        "    \"user_prompt\": [\n",
        "        \"What are the symptoms of COVID-19?\",\n",
        "        \"How effective is the flu vaccine this year?\",\n",
        "        \"What are the causes of global warming?\",\n",
        "        \"How does exercise affect mental health?\",\n",
        "        \"What are the benefits of meditation?\",\n",
        "        \"How do vaccines work?\",\n",
        "        \"What is artificial intelligence?\",\n",
        "        \"What are the side effects of the COVID-19 vaccine?\",\n",
        "        \"How to reduce stress at work?\",\n",
        "        \"What are the signs of depression?\",\n",
        "        \"How to prevent heart disease?\",\n",
        "        \"What is quantum computing?\",\n",
        "        \"What is the best diet for weight loss?\",\n",
        "        \"How does climate change affect wildlife?\",\n",
        "        \"What are the symptoms of anxiety?\",\n",
        "        \"How to improve sleep quality?\",\n",
        "        \"What are the symptoms of the flu?\",\n",
        "        \"What is the difference between Type 1 and Type 2 diabetes?\",\n",
        "        \"How to manage time effectively?\",\n",
        "        \"What is the impact of social media on teenagers?\"\n",
        "    ],\n",
        "    \"func_rating\": [3, 2, 2, 4, 2, 4, 3, 4, 2, 3, 4, 4, 3, 4, 4, 4, 3, 3, 4, 2],\n",
        "    \"custom_rating\": [4, 3, 4, 3, 3, 4, 4, 3, 3, 2, 4, 4, 3, 4, 4, 3, 4, 3, 2, 3]\n",
        "}\n",
        "\n",
        "# Convert to DataFrame and display\n",
        "df = pd.DataFrame(data)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "NCf1gP0rkZGe"
      },
      "source": [
        "When using `to_categorical` function, watch out for unique levels in `custom_rating` column."
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 4,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "Kcuq96xNkT66",
        "outputId": "59b6a687-5481-453d-fb71-4ed571e104b8"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([4, 3, 2])"
            ]
          },
          "metadata": {},
          "execution_count": 4
        }
      ],
      "source": [
        "df[\"custom_rating\"].unique()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 5,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "baEm3cICbDzG",
        "outputId": "4b86242a-1eb2-440f-d82a-b42dc5b1d2ce"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "(20, 3)"
            ]
          },
          "metadata": {},
          "execution_count": 5
        }
      ],
      "source": [
        "df.shape"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 6,
      "metadata": {
        "id": "diA2SVoSUY9M"
      },
      "outputs": [],
      "source": [
        "import pandas as pd\n",
        "import requests\n",
        "from io import StringIO\n",
        "\n",
        "def download_and_combine_csv(urls: list) -> pd.DataFrame:\n",
        "    \"\"\"\n",
        "    Download CSV files from provided URLs and combine them row-wise.\n",
        "    It will combine files if they have the expected column names or just the correct number of columns.\n",
        "    Handles different encodings to avoid common decoding errors. Converts certain columns to integer form.\n",
        "\n",
        "    Args:\n",
        "    urls (list): List of strings containing the URLs of the CSV files.\n",
        "\n",
        "    Returns:\n",
        "    pd.DataFrame: A DataFrame containing the combined data from all matching CSV files.\n",
        "    \"\"\"\n",
        "    expected_columns = {'user_prompt', 'url_to_check', 'func_rating', 'custom_rating'}\n",
        "    combined_df = pd.DataFrame()\n",
        "\n",
        "    for url in urls:\n",
        "        try:\n",
        "            # Modify the GitHub URL to point to the raw version of the file\n",
        "            raw_url = url.replace('github.com', 'raw.githubusercontent.com').replace('/blob', '')\n",
        "\n",
        "            response = requests.get(raw_url)\n",
        "            if response.status_code == 200:\n",
        "                try:\n",
        "                    # Attempt to read with utf-8 encoding\n",
        "                    content = response.content.decode('utf-8')\n",
        "                except UnicodeDecodeError:\n",
        "                    # Attempt to read with latin1 encoding\n",
        "                    content = response.content.decode('latin1')\n",
        "\n",
        "                # Read the CSV file into a DataFrame\n",
        "                df = pd.read_csv(StringIO(content))\n",
        "\n",
        "                # Check if the columns match the expected columns or if there are at least 4 columns\n",
        "                if set(df.columns) == expected_columns:\n",
        "                    combined_df = pd.concat([combined_df, df], ignore_index=True)\n",
        "                elif len(df.columns) >= 4:\n",
        "                    # Assume the first 4 columns are the required ones and ignore the original column names\n",
        "                    df = df.iloc[:, :4]\n",
        "                    df.columns = ['user_prompt', 'url_to_check', 'func_rating', 'custom_rating']\n",
        "                    combined_df = pd.concat([combined_df, df], ignore_index=True)\n",
        "                else:\n",
        "                    print(f\"Skipping file with insufficient columns: {url}\")\n",
        "            else:\n",
        "                print(f\"Failed to download from {url}\")\n",
        "        except Exception as e:\n",
        "            print(f\"Error processing {url}: {str(e)}\")\n",
        "\n",
        "    # Ensure func_rating and custom_rating are integers\n",
        "    if not combined_df.empty:\n",
        "        combined_df['func_rating'] = combined_df['func_rating'].round().astype(int)\n",
        "        combined_df['custom_rating'] = combined_df['custom_rating'].round().astype(int)\n",
        "\n",
        "    return combined_df\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 7,
      "metadata": {
        "id": "jxd9olLsUcyP"
      },
      "outputs": [],
      "source": [
        "# Example usage:\n",
        "urls = [\n",
        "    \"https://github.com/vrutika-prajapati/Credibility-Score-for-Articles/blob/main/projects/deliverable%202/Url_validation.csv\",\n",
        "    \"https://github.com/Saikumar08-sk/URL-Validation/blob/main/Deliverable.csv\",\n",
        "    \"https://github.com/aditya19111/Project-1-Credibility-Score-for-Articles-Sources-References/blob/main/Deliverable_2/Deliverables_rating_comparison%20-%20Sheet1.csv\",\n",
        "    \"https://github.com/SAIKUMAR500/algorithums-for-data-science/blob/main/deliverable2/dataset(Sheet1).csv\",\n",
        "    \"https://github.com/drashti-sanghani/Credibility_score_articles/blob/main/Project/Deliverable2/user_ratings.csv\",\n",
        "    \"https://github.com/anchalrai101/CREDIBILITY-SCORE/blob/main/urltesting_scores.csv\",\n",
        "    \"https://github.com/AliSInamdar/CS676-Ali-Inamdar/blob/Project_1_Credibilty_Score/Deliverable_2/Deliverable_2.csv\",\n",
        "    \"https://github.com/bhavnaa22/Algorithms-For-Data-Science/blob/main/Deliverable%202/Deliverable2.csv\",\n",
        "    \"https://github.com/bhatthardik4/AlgorithmDS/blob/main/Deliverable_2/HardikBhattD2.csv\",\n",
        "    \"https://github.com/Rakeshkanche/Algorithms-for-Data-Science/blob/main/queries_urls_ratings.csv\",\n",
        "    \"https://github.com/kristinakim-code/Credibility-Check/blob/main/deliverable2.csv\",\n",
        "    \"https://github.com/bhavnaa22/Algorithms-For-Data-Science/blob/main/Deliverable%202/Deliverable2.csv\",\n",
        "    \"https://github.com/kamaldomandula/Algorithms-of-data-science-Project/blob/main/Project/project1/Deliverable2/deliverable.csv\",\n",
        "    \"https://github.com/ChinmayShetye26/Algo-for-DS-delivery2/blob/main/Sample.csv\",\n",
        "    \"https://github.com/krishnam229/Project1/blob/main/deliverable2/sample.csv\",\n",
        "    \"https://github.com/drona23/Deliverable2/blob/main/output.csv\",\n",
        "]"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 8,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 206
        },
        "id": "hAm8UE-nUfK3",
        "outputId": "fa875725-ecc8-4ff4-b940-f4e0fc564cb4"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "                                         user_prompt  \\\n",
              "0  I have just been on an international flight, c...   \n",
              "1        What are the benefits of a vegetarian diet?   \n",
              "2        What are the benefits of a vegetarian diet?   \n",
              "3        What are the benefits of a vegetarian diet?   \n",
              "4  How to improve mental health during stressful ...   \n",
              "\n",
              "                                        url_to_check  func_rating  \\\n",
              "0  https://www.mayoclinic.org/healthy-lifestyle/i...            2   \n",
              "1  https://www.nhs.uk/live-well/eat-well/how-to-e...            2   \n",
              "2  https://www.nhs.uk/live-well/eat-well/how-to-e...            2   \n",
              "3  https://pubmed.ncbi.nlm.nih.gov/37226630/#:~:t...            2   \n",
              "4  https://www.who.int/news-room/questions-and-an...            3   \n",
              "\n",
              "   custom_rating  \n",
              "0              3  \n",
              "1              4  \n",
              "2              2  \n",
              "3              3  \n",
              "4              3  "
            ],
            "text/html": [
              "\n",
              "  <div id=\"df-2bb03f1a-b6c8-4684-8b6d-b25df09635fe\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>user_prompt</th>\n",
              "      <th>url_to_check</th>\n",
              "      <th>func_rating</th>\n",
              "      <th>custom_rating</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>I have just been on an international flight, c...</td>\n",
              "      <td>https://www.mayoclinic.org/healthy-lifestyle/i...</td>\n",
              "      <td>2</td>\n",
              "      <td>3</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>What are the benefits of a vegetarian diet?</td>\n",
              "      <td>https://www.nhs.uk/live-well/eat-well/how-to-e...</td>\n",
              "      <td>2</td>\n",
              "      <td>4</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>What are the benefits of a vegetarian diet?</td>\n",
              "      <td>https://www.nhs.uk/live-well/eat-well/how-to-e...</td>\n",
              "      <td>2</td>\n",
              "      <td>2</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>What are the benefits of a vegetarian diet?</td>\n",
              "      <td>https://pubmed.ncbi.nlm.nih.gov/37226630/#:~:t...</td>\n",
              "      <td>2</td>\n",
              "      <td>3</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>How to improve mental health during stressful ...</td>\n",
              "      <td>https://www.who.int/news-room/questions-and-an...</td>\n",
              "      <td>3</td>\n",
              "      <td>3</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-2bb03f1a-b6c8-4684-8b6d-b25df09635fe')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-2bb03f1a-b6c8-4684-8b6d-b25df09635fe button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-2bb03f1a-b6c8-4684-8b6d-b25df09635fe');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-39ba09e8-9a26-4641-b0e8-2f81a35755f0\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-39ba09e8-9a26-4641-b0e8-2f81a35755f0')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-39ba09e8-9a26-4641-b0e8-2f81a35755f0 button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "application/vnd.google.colaboratory.intrinsic+json": {
              "type": "dataframe",
              "variable_name": "result_df",
              "summary": "{\n  \"name\": \"result_df\",\n  \"rows\": 282,\n  \"fields\": [\n    {\n      \"column\": \"user_prompt\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 240,\n        \"samples\": [\n          \"deep learning sleep algorithm details and its working\",\n          \"How does climate change impact global weather?\",\n          \"\\\"Is it safe to do strength training exercises during pregnancy?\\\"\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"url_to_check\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 262,\n        \"samples\": [\n          \"https://www.psychologytoday.com/us/articles/201803/how-stop-self-sabotage\",\n          \"https://www.psychologytoday.com/us/articles/201608/how-to-stop-procrastinating\",\n          \"https://www.cdc.gov/nchs/fastats/heart-disease.htm\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"func_rating\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 0,\n        \"min\": 0,\n        \"max\": 5,\n        \"num_unique_values\": 6,\n        \"samples\": [\n          2,\n          3,\n          0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"custom_rating\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1,\n        \"min\": 0,\n        \"max\": 5,\n        \"num_unique_values\": 6,\n        \"samples\": [\n          3,\n          4,\n          0\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}"
            }
          },
          "metadata": {},
          "execution_count": 8
        }
      ],
      "source": [
        "result_df = download_and_combine_csv(urls)\n",
        "result_df.head()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 9,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "jxDgxTFsUm0X",
        "outputId": "6a5f2a26-1c2c-42be-f60d-9b3a86e47530"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "(282, 4)\n"
          ]
        }
      ],
      "source": [
        "df = result_df.copy()\n",
        "\n",
        "print(df.shape)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "cwQCqPvfUR7g"
      },
      "source": [
        "### Tokenizer to Process Text"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 10,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "moxZqZxYO1aP",
        "outputId": "169dd89f-4728-4bbc-dab7-8d6b8f0ce892"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "(282, 26)\n",
            "(282, 1)\n",
            "(282, 1)\n"
          ]
        }
      ],
      "source": [
        "# Tokenize and prepare data\n",
        "tokenizer = Tokenizer()\n",
        "tokenizer.fit_on_texts(df[\"user_prompt\"])\n",
        "vocab_size = len(tokenizer.word_index) + 1\n",
        "max_length = max([len(x.split()) for x in df[\"user_prompt\"]])\n",
        "embedding_dim = 8\n",
        "\n",
        "# Convert text data into sequences\n",
        "X_text = tokenizer.texts_to_sequences(df[\"user_prompt\"])\n",
        "X_text = pad_sequences(X_text, maxlen=max_length, padding='post')\n",
        "print(X_text.shape)\n",
        "\n",
        "# Numeric input\n",
        "X_func_rating = np.array(df[\"func_rating\"]).reshape(-1, 1)\n",
        "print(X_func_rating.shape)\n",
        "\n",
        "# Target variable\n",
        "y = np.array(df[\"custom_rating\"]).reshape(-1, 1)\n",
        "print(y.shape)"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "import numpy as np\n",
        "from sklearn.utils.class_weight import compute_class_weight\n",
        "\n",
        "all_classes = np.arange(6)  # Explicitly specify classes 0 to 5\n",
        "\n",
        "# Compute class weights\n",
        "class_weights = compute_class_weight(\n",
        "    class_weight=\"balanced\",\n",
        "    classes=all_classes,  # Pass all possible classes\n",
        "    y=y.flatten()  # Flatten y to match the class indices\n",
        ")\n",
        "\n",
        "# Convert to dictionary format\n",
        "class_weights_dict = {i: class_weights[i] for i in range(len(class_weights))}\n",
        "print(\"Class Weights:\", class_weights_dict)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "8o3wkwtomfoY",
        "outputId": "c45a97e2-468d-4b72-e828-762fa03cfb9c"
      },
      "execution_count": 11,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Class Weights: {0: np.float64(5.222222222222222), 1: np.float64(2.611111111111111), 2: np.float64(1.3428571428571427), 3: np.float64(0.30718954248366015), 4: np.float64(0.8867924528301887), 5: np.float64(3.357142857142857)}\n"
          ]
        }
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 12,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 180,
          "referenced_widgets": [
            "e186266aafe04a6dbf1f61bea7a968e0",
            "1bfcd41a70194908b7022f575521d3a9",
            "4d57528b45154030bcac2c0fbae9f7b1",
            "3a1894afc0be49eb9779463c1a597346",
            "07bf14be46074e99a98d5560dad1b498",
            "851de16ab61349d5892e639154e8c517",
            "34168978d0774ca688ed5df3f20762f7",
            "7a372da2a44943a8adbdc362f436b406",
            "cc951c80abf24eaaaeec85da75510b61",
            "5ff94fb200f6492cbdad767a0198a8dd",
            "6790398a554e4dc7b2dfd81df0117977",
            "034d8e7c165f4c81b9ba2bf775cf9bd6",
            "e67251b40cff4b13a6c50bcd72de3bb9",
            "af6d5bc305cd40b1b44b0eed48a376ba",
            "abd1f752d3964adda85a58824df09c41",
            "04965b9c9b9b49a1a836117e7ba46b30",
            "f0f911ce2456490b965bdb1cb0647c21",
            "59688b76a2874520be896e685840cd36",
            "cdd2c12a74dd436197762c783233a9e2",
            "24697ad8cd644e76942a6e00ec72f7a2",
            "477060f80c534b3196b7c83e9d51a0a9",
            "b7859de3a5284557b01cc4b74b57fcfe",
            "167d36e8c7794f35939a8769311b3b9b",
            "4d0e190ab5634eecac147bd0868cc23b",
            "a325244b644c4417a1f03ba8a7a93dcf",
            "87c7bb952db743179aecaee43da95b4f",
            "4ba63661ba7d4ab69b5b528ba6d04ad1",
            "68f996dd375341a79afe301580a7e90f",
            "28df4e3cc1524c3a8dc0bdd0e146bdc9",
            "b1edb36e958c4a30922a4ddf30f206a5",
            "5db6fbb88195480d965e6ae4172ac7e0",
            "aefe0dc3831b428d8f7038aa079cef6a",
            "85b9d14eb45343269196336a3ed2d304",
            "eb2f380189134622b085971c5ed36849",
            "1538646a0d1540f999e08af770c11800",
            "0b899d93e257476b9f908469a91a682e",
            "999f56797bab4fde968cecf4117d4772",
            "f79f971ec1b145d89bae555ed5f12998",
            "52fc71a0047843eb88cacb3bfd949e14",
            "38f6a7143a7a476383adc486a6cf6dc1",
            "fb3ba6ff04ca41d49bd5d1deae03f01d",
            "d6a24cb4eb924af09ceb4751e22057c4",
            "6280188efb824ee2a5828638691cc7c2",
            "5c0021bd6b504caa85791e88eee729cd"
          ]
        },
        "id": "CHnd1nl2WdQb",
        "outputId": "9d681ee7-0559-4bd7-b346-03136708bb9b"
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "tokenizer_config.json:   0%|          | 0.00/48.0 [00:00<?, ?B/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "e186266aafe04a6dbf1f61bea7a968e0"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "vocab.txt:   0%|          | 0.00/232k [00:00<?, ?B/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "034d8e7c165f4c81b9ba2bf775cf9bd6"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "tokenizer.json:   0%|          | 0.00/466k [00:00<?, ?B/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "167d36e8c7794f35939a8769311b3b9b"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "config.json:   0%|          | 0.00/570 [00:00<?, ?B/s]"
            ],
            "application/vnd.jupyter.widget-view+json": {
              "version_major": 2,
              "version_minor": 0,
              "model_id": "eb2f380189134622b085971c5ed36849"
            }
          },
          "metadata": {}
        },
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "(282, 512)\n",
            "(282, 512)\n"
          ]
        }
      ],
      "source": [
        "from transformers import BertTokenizer, TFBertModel\n",
        "import tensorflow as tf\n",
        "\n",
        "# Initialize the BERT tokenizer\n",
        "tokenizer = BertTokenizer.from_pretrained('bert-base-uncased')\n",
        "\n",
        "# Tokenize and prepare data for BERT\n",
        "def prepare_data(texts):\n",
        "    \"\"\"\n",
        "    Prepares input text data into tokenized tensors for BERT.\n",
        "\n",
        "    Args:\n",
        "    texts (pd.Series): A pandas series containing text entries.\n",
        "\n",
        "    Returns:\n",
        "    tf.Tensor: Tokenized and formatted input for BERT.\n",
        "    \"\"\"\n",
        "    input_ids = []\n",
        "    attention_masks = []\n",
        "\n",
        "    for text in texts:\n",
        "        encoded = tokenizer.encode_plus(\n",
        "            text,\n",
        "            add_special_tokens=True,\n",
        "            max_length=512, # Can adjust depending on your specific needs\n",
        "            truncation=True,\n",
        "            padding='max_length',\n",
        "            return_attention_mask=True,\n",
        "            return_tensors='tf',\n",
        "        )\n",
        "        input_ids.append(encoded['input_ids'])\n",
        "        attention_masks.append(encoded['attention_mask'])\n",
        "\n",
        "    input_ids = tf.concat(input_ids, axis=0)\n",
        "    attention_masks = tf.concat(attention_masks, axis=0)\n",
        "\n",
        "    return input_ids, attention_masks\n",
        "\n",
        "# Example usage\n",
        "X_text, X_mask = prepare_data(df[\"user_prompt\"])\n",
        "\n",
        "print(X_text.shape)  # This will show the shape of your input_ids\n",
        "print(X_mask.shape)  # This will show the shape of your attention masks\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 13,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "EmsPxbzIWmjO",
        "outputId": "269a838b-3093-4869-8111-99fd967e477f"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "<tf.Tensor: shape=(282, 512), dtype=int32, numpy=\n",
              "array([[1, 1, 1, ..., 0, 0, 0],\n",
              "       [1, 1, 1, ..., 0, 0, 0],\n",
              "       [1, 1, 1, ..., 0, 0, 0],\n",
              "       ...,\n",
              "       [1, 1, 1, ..., 0, 0, 0],\n",
              "       [1, 1, 1, ..., 0, 0, 0],\n",
              "       [1, 1, 1, ..., 0, 0, 0]], dtype=int32)>"
            ]
          },
          "metadata": {},
          "execution_count": 13
        }
      ],
      "source": [
        "X_mask"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 14,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "-6D2ffwseoXw",
        "outputId": "43c34547-74bd-48d3-f9c7-ad6a352d73e4"
      },
      "outputs": [
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "array([3, 4, 2, 5, 1, 0])"
            ]
          },
          "metadata": {},
          "execution_count": 14
        }
      ],
      "source": [
        "df[\"custom_rating\"].unique()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 20,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "EUajlfyWkFEo",
        "outputId": "3ab8e346-48b0-48ef-b75b-199e3608f790"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "(282, 2)\n"
          ]
        }
      ],
      "source": [
        "from keras.utils import to_categorical\n",
        "\n",
        "# Assuming y is your array of class labels shaped as (20, 1)\n",
        "# Convert labels to one-hot encoding\n",
        "y_one_hot = to_categorical(y > 3)\n",
        "\n",
        "# Check the new shape of y_one_hot\n",
        "print(y_one_hot.shape)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "NVT9xIpSUU50"
      },
      "source": [
        "## Instantiate Model"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 17,
      "metadata": {
        "id": "7uAZerbZO_UA"
      },
      "outputs": [],
      "source": [
        "# Create the model\n",
        "num_of_dense_layers = 2  # Example: 2 dense layers before concatenation\n",
        "model = create_nn_model(vocab_size, embedding_dim, max_length, num_of_dense_layers, 2)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 18,
      "metadata": {
        "id": "W8vFhHs8YUVj"
      },
      "outputs": [],
      "source": [
        "# Example of setting parameters based on your dataset\n",
        "vocab_size = 30 # Example for BERT-base which has a vocab size of about 30,522\n",
        "embedding_dim = 128  # Example dimensionality\n",
        "max_length = 512  # From your output, each input sequence length\n",
        "num_of_dense = 10  # Example of using five dense layers\n",
        "output_dim = 2  # Number of output classes, change this as per your specific task\n",
        "\n",
        "# Initialize the model with the parameters\n",
        "model = create_nn_model(vocab_size=vocab_size, embedding_dim=embedding_dim, max_length=max_length, num_of_dense=num_of_dense, output_dim=output_dim)"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "Es9AE-AVUXvd"
      },
      "source": [
        "## Training"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 21,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "hNTu_mbjT9Wk",
        "outputId": "09362563-32ce-4fe9-f659-d33546f15801"
      },
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "Before SMOTE: (253, 513) (253, 2)\n",
            "After SMOTE: (382, 513) (382, 2)\n",
            "Epoch 1/100\n",
            "24/24 - 33s - 1s/step - accuracy: 0.5000 - loss: 40.6226 - val_accuracy: 0.8276 - val_loss: 25.2983 - learning_rate: 1.0000e-03\n",
            "Epoch 2/100\n",
            "24/24 - 18s - 752ms/step - accuracy: 0.4843 - loss: 19.3624 - val_accuracy: 0.8276 - val_loss: 15.6297 - learning_rate: 1.0000e-03\n",
            "Epoch 3/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.5157 - loss: 13.1325 - val_accuracy: 0.8276 - val_loss: 10.3797 - learning_rate: 1.0000e-03\n",
            "Epoch 4/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.5157 - loss: 9.2038 - val_accuracy: 0.8276 - val_loss: 8.3670 - learning_rate: 1.0000e-03\n",
            "Epoch 5/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.5314 - loss: 7.2402 - val_accuracy: 0.8276 - val_loss: 6.5720 - learning_rate: 1.0000e-03\n",
            "Epoch 6/100\n",
            "24/24 - 1s - 28ms/step - accuracy: 0.5262 - loss: 5.7254 - val_accuracy: 0.8276 - val_loss: 4.6310 - learning_rate: 1.0000e-03\n",
            "Epoch 7/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.5026 - loss: 4.3857 - val_accuracy: 0.8276 - val_loss: 4.2294 - learning_rate: 1.0000e-03\n",
            "Epoch 8/100\n",
            "24/24 - 1s - 27ms/step - accuracy: 0.5681 - loss: 3.9154 - val_accuracy: 0.8276 - val_loss: 3.2319 - learning_rate: 1.0000e-03\n",
            "Epoch 9/100\n",
            "24/24 - 1s - 55ms/step - accuracy: 0.5838 - loss: 2.6872 - val_accuracy: 0.8276 - val_loss: 2.6462 - learning_rate: 1.0000e-03\n",
            "Epoch 10/100\n",
            "24/24 - 1s - 25ms/step - accuracy: 0.5759 - loss: 2.3665 - val_accuracy: 0.8276 - val_loss: 1.8527 - learning_rate: 1.0000e-03\n",
            "Epoch 11/100\n",
            "24/24 - 1s - 51ms/step - accuracy: 0.5445 - loss: 1.6914 - val_accuracy: 0.8276 - val_loss: 1.4656 - learning_rate: 1.0000e-03\n",
            "Epoch 12/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.5890 - loss: 1.3560 - val_accuracy: 0.8276 - val_loss: 1.1554 - learning_rate: 1.0000e-03\n",
            "Epoch 13/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6178 - loss: 1.0590 - val_accuracy: 0.8276 - val_loss: 0.9539 - learning_rate: 1.0000e-03\n",
            "Epoch 14/100\n",
            "24/24 - 1s - 27ms/step - accuracy: 0.5471 - loss: 1.0293 - val_accuracy: 0.8276 - val_loss: 0.8539 - learning_rate: 1.0000e-03\n",
            "Epoch 15/100\n",
            "24/24 - 0s - 18ms/step - accuracy: 0.5497 - loss: 0.8667 - val_accuracy: 0.8276 - val_loss: 0.9431 - learning_rate: 1.0000e-03\n",
            "Epoch 16/100\n",
            "24/24 - 1s - 33ms/step - accuracy: 0.6204 - loss: 0.6892 - val_accuracy: 0.8276 - val_loss: 0.6031 - learning_rate: 1.0000e-03\n",
            "Epoch 17/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.5864 - loss: 0.5178 - val_accuracy: 0.8276 - val_loss: 0.4851 - learning_rate: 1.0000e-03\n",
            "Epoch 18/100\n",
            "24/24 - 1s - 27ms/step - accuracy: 0.6204 - loss: 0.4622 - val_accuracy: 0.8276 - val_loss: 0.3986 - learning_rate: 1.0000e-03\n",
            "Epoch 19/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6126 - loss: 0.3761 - val_accuracy: 0.8276 - val_loss: 0.3330 - learning_rate: 1.0000e-03\n",
            "Epoch 20/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6283 - loss: 0.3177 - val_accuracy: 0.8276 - val_loss: 0.2899 - learning_rate: 1.0000e-03\n",
            "Epoch 21/100\n",
            "24/24 - 0s - 16ms/step - accuracy: 0.6152 - loss: 0.5021 - val_accuracy: 0.8276 - val_loss: 0.4079 - learning_rate: 1.0000e-03\n",
            "Epoch 22/100\n",
            "24/24 - 1s - 25ms/step - accuracy: 0.5969 - loss: 0.3352 - val_accuracy: 0.8276 - val_loss: 0.2667 - learning_rate: 1.0000e-03\n",
            "Epoch 23/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6073 - loss: 0.2486 - val_accuracy: 0.8276 - val_loss: 0.2189 - learning_rate: 1.0000e-03\n",
            "Epoch 24/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6178 - loss: 0.2149 - val_accuracy: 0.8276 - val_loss: 0.2014 - learning_rate: 1.0000e-03\n",
            "Epoch 25/100\n",
            "24/24 - 1s - 41ms/step - accuracy: 0.6126 - loss: 0.2035 - val_accuracy: 0.8276 - val_loss: 0.1835 - learning_rate: 1.0000e-03\n",
            "Epoch 26/100\n",
            "24/24 - 1s - 58ms/step - accuracy: 0.6152 - loss: 0.1773 - val_accuracy: 0.8276 - val_loss: 0.1631 - learning_rate: 1.0000e-03\n",
            "Epoch 27/100\n",
            "24/24 - 1s - 36ms/step - accuracy: 0.6257 - loss: 0.1667 - val_accuracy: 0.8276 - val_loss: 0.1621 - learning_rate: 1.0000e-03\n",
            "Epoch 28/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6204 - loss: 0.1581 - val_accuracy: 0.8276 - val_loss: 0.1483 - learning_rate: 1.0000e-03\n",
            "Epoch 29/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6204 - loss: 0.1475 - val_accuracy: 0.8276 - val_loss: 0.1403 - learning_rate: 1.0000e-03\n",
            "Epoch 30/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6204 - loss: 0.1399 - val_accuracy: 0.8276 - val_loss: 0.1318 - learning_rate: 1.0000e-03\n",
            "Epoch 31/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.5838 - loss: 0.1339 - val_accuracy: 0.8276 - val_loss: 0.1256 - learning_rate: 1.0000e-03\n",
            "Epoch 32/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6204 - loss: 0.1283 - val_accuracy: 0.8276 - val_loss: 0.1195 - learning_rate: 1.0000e-03\n",
            "Epoch 33/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6204 - loss: 0.1241 - val_accuracy: 0.8276 - val_loss: 0.1182 - learning_rate: 1.0000e-03\n",
            "Epoch 34/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.5785 - loss: 0.1205 - val_accuracy: 0.8276 - val_loss: 0.1145 - learning_rate: 1.0000e-03\n",
            "Epoch 35/100\n",
            "24/24 - 1s - 27ms/step - accuracy: 0.6204 - loss: 0.1162 - val_accuracy: 0.8276 - val_loss: 0.1092 - learning_rate: 1.0000e-03\n",
            "Epoch 36/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6204 - loss: 0.1127 - val_accuracy: 0.8276 - val_loss: 0.1067 - learning_rate: 1.0000e-03\n",
            "Epoch 37/100\n",
            "24/24 - 1s - 25ms/step - accuracy: 0.6204 - loss: 0.1098 - val_accuracy: 0.8276 - val_loss: 0.1033 - learning_rate: 1.0000e-03\n",
            "Epoch 38/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6204 - loss: 0.1072 - val_accuracy: 0.8276 - val_loss: 0.1032 - learning_rate: 1.0000e-03\n",
            "Epoch 39/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6204 - loss: 0.1049 - val_accuracy: 0.8276 - val_loss: 0.0975 - learning_rate: 1.0000e-03\n",
            "Epoch 40/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6204 - loss: 0.1026 - val_accuracy: 0.8276 - val_loss: 0.0947 - learning_rate: 1.0000e-03\n",
            "Epoch 41/100\n",
            "24/24 - 1s - 23ms/step - accuracy: 0.6204 - loss: 0.1005 - val_accuracy: 0.8276 - val_loss: 0.0947 - learning_rate: 1.0000e-03\n",
            "Epoch 42/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6204 - loss: 0.0986 - val_accuracy: 0.8276 - val_loss: 0.0921 - learning_rate: 1.0000e-03\n",
            "Epoch 43/100\n",
            "24/24 - 1s - 23ms/step - accuracy: 0.6204 - loss: 0.0971 - val_accuracy: 0.8276 - val_loss: 0.0921 - learning_rate: 1.0000e-03\n",
            "Epoch 44/100\n",
            "24/24 - 1s - 34ms/step - accuracy: 0.6414 - loss: 0.0955 - val_accuracy: 0.8276 - val_loss: 0.0908 - learning_rate: 1.0000e-03\n",
            "Epoch 45/100\n",
            "24/24 - 1s - 30ms/step - accuracy: 0.6492 - loss: 0.0938 - val_accuracy: 0.8276 - val_loss: 0.0893 - learning_rate: 1.0000e-03\n",
            "Epoch 46/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6492 - loss: 0.0926 - val_accuracy: 0.8276 - val_loss: 0.0854 - learning_rate: 1.0000e-03\n",
            "Epoch 47/100\n",
            "24/24 - 1s - 25ms/step - accuracy: 0.6492 - loss: 0.0912 - val_accuracy: 0.8276 - val_loss: 0.0849 - learning_rate: 1.0000e-03\n",
            "Epoch 48/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6492 - loss: 0.0904 - val_accuracy: 0.8276 - val_loss: 0.0842 - learning_rate: 1.0000e-03\n",
            "Epoch 49/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6492 - loss: 0.0893 - val_accuracy: 0.8276 - val_loss: 0.0841 - learning_rate: 1.0000e-03\n",
            "Epoch 50/100\n",
            "24/24 - 1s - 28ms/step - accuracy: 0.6492 - loss: 0.0880 - val_accuracy: 0.8276 - val_loss: 0.0834 - learning_rate: 1.0000e-03\n",
            "Epoch 51/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6492 - loss: 0.0873 - val_accuracy: 0.8276 - val_loss: 0.0826 - learning_rate: 1.0000e-03\n",
            "Epoch 52/100\n",
            "24/24 - 1s - 25ms/step - accuracy: 0.6492 - loss: 0.0862 - val_accuracy: 0.8276 - val_loss: 0.0803 - learning_rate: 1.0000e-03\n",
            "Epoch 53/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6492 - loss: 0.0854 - val_accuracy: 0.8276 - val_loss: 0.0802 - learning_rate: 1.0000e-03\n",
            "Epoch 54/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6492 - loss: 0.0847 - val_accuracy: 0.8276 - val_loss: 0.0795 - learning_rate: 1.0000e-03\n",
            "Epoch 55/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6492 - loss: 0.0841 - val_accuracy: 0.8276 - val_loss: 0.0786 - learning_rate: 1.0000e-03\n",
            "Epoch 56/100\n",
            "24/24 - 1s - 27ms/step - accuracy: 0.6492 - loss: 0.0838 - val_accuracy: 0.8276 - val_loss: 0.0739 - learning_rate: 1.0000e-03\n",
            "Epoch 57/100\n",
            "24/24 - 0s - 17ms/step - accuracy: 0.6361 - loss: 0.0830 - val_accuracy: 0.8276 - val_loss: 0.0784 - learning_rate: 1.0000e-03\n",
            "Epoch 58/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6492 - loss: 0.0827 - val_accuracy: 0.8276 - val_loss: 0.0733 - learning_rate: 1.0000e-03\n",
            "Epoch 59/100\n",
            "24/24 - 0s - 16ms/step - accuracy: 0.6361 - loss: 0.0819 - val_accuracy: 0.8276 - val_loss: 0.0761 - learning_rate: 1.0000e-03\n",
            "Epoch 60/100\n",
            "24/24 - 1s - 28ms/step - accuracy: 0.6492 - loss: 0.0812 - val_accuracy: 0.8276 - val_loss: 0.0759 - learning_rate: 1.0000e-03\n",
            "Epoch 61/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6492 - loss: 0.0805 - val_accuracy: 0.8276 - val_loss: 0.0723 - learning_rate: 1.0000e-03\n",
            "Epoch 62/100\n",
            "24/24 - 0s - 19ms/step - accuracy: 0.6492 - loss: 0.0802 - val_accuracy: 0.8276 - val_loss: 0.0736 - learning_rate: 1.0000e-03\n",
            "Epoch 63/100\n",
            "24/24 - 1s - 28ms/step - accuracy: 0.6492 - loss: 0.0800 - val_accuracy: 0.8276 - val_loss: 0.0746 - learning_rate: 1.0000e-03\n",
            "Epoch 64/100\n",
            "24/24 - 0s - 20ms/step - accuracy: 0.6492 - loss: 0.0794 - val_accuracy: 0.8276 - val_loss: 0.0755 - learning_rate: 1.0000e-03\n",
            "Epoch 65/100\n",
            "24/24 - 1s - 22ms/step - accuracy: 0.6492 - loss: 0.0791 - val_accuracy: 0.8276 - val_loss: 0.0728 - learning_rate: 1.0000e-03\n",
            "Epoch 66/100\n",
            "\n",
            "Epoch 66: ReduceLROnPlateau reducing learning rate to 0.0005000000237487257.\n",
            "24/24 - 0s - 20ms/step - accuracy: 0.6492 - loss: 0.0790 - val_accuracy: 0.8276 - val_loss: 0.0731 - learning_rate: 1.0000e-03\n",
            "Epoch 67/100\n",
            "24/24 - 0s - 17ms/step - accuracy: 0.6492 - loss: 0.0785 - val_accuracy: 0.8276 - val_loss: 0.0726 - learning_rate: 5.0000e-04\n",
            "Epoch 68/100\n",
            "24/24 - 1s - 27ms/step - accuracy: 0.6492 - loss: 0.0787 - val_accuracy: 0.8276 - val_loss: 0.0731 - learning_rate: 5.0000e-04\n",
            "Epoch 69/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6492 - loss: 0.0782 - val_accuracy: 0.8276 - val_loss: 0.0723 - learning_rate: 5.0000e-04\n",
            "Epoch 70/100\n",
            "24/24 - 1s - 31ms/step - accuracy: 0.6492 - loss: 0.0781 - val_accuracy: 0.8276 - val_loss: 0.0720 - learning_rate: 5.0000e-04\n",
            "Epoch 71/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6492 - loss: 0.0779 - val_accuracy: 0.8276 - val_loss: 0.0707 - learning_rate: 5.0000e-04\n",
            "Epoch 72/100\n",
            "24/24 - 0s - 16ms/step - accuracy: 0.6492 - loss: 0.0777 - val_accuracy: 0.8276 - val_loss: 0.0717 - learning_rate: 5.0000e-04\n",
            "Epoch 73/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6492 - loss: 0.0777 - val_accuracy: 0.8276 - val_loss: 0.0718 - learning_rate: 5.0000e-04\n",
            "Epoch 74/100\n",
            "24/24 - 1s - 35ms/step - accuracy: 0.6492 - loss: 0.0775 - val_accuracy: 0.8276 - val_loss: 0.0700 - learning_rate: 5.0000e-04\n",
            "Epoch 75/100\n",
            "24/24 - 0s - 16ms/step - accuracy: 0.6492 - loss: 0.0774 - val_accuracy: 0.8276 - val_loss: 0.0712 - learning_rate: 5.0000e-04\n",
            "Epoch 76/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6492 - loss: 0.0773 - val_accuracy: 0.8276 - val_loss: 0.0725 - learning_rate: 5.0000e-04\n",
            "Epoch 77/100\n",
            "24/24 - 0s - 16ms/step - accuracy: 0.6492 - loss: 0.0771 - val_accuracy: 0.8276 - val_loss: 0.0705 - learning_rate: 5.0000e-04\n",
            "Epoch 78/100\n",
            "24/24 - 1s - 33ms/step - accuracy: 0.6492 - loss: 0.0771 - val_accuracy: 0.8276 - val_loss: 0.0694 - learning_rate: 5.0000e-04\n",
            "Epoch 79/100\n",
            "24/24 - 0s - 16ms/step - accuracy: 0.6492 - loss: 0.0770 - val_accuracy: 0.8276 - val_loss: 0.0708 - learning_rate: 5.0000e-04\n",
            "Epoch 80/100\n",
            "24/24 - 1s - 28ms/step - accuracy: 0.6492 - loss: 0.0768 - val_accuracy: 0.8276 - val_loss: 0.0695 - learning_rate: 5.0000e-04\n",
            "Epoch 81/100\n",
            "24/24 - 0s - 18ms/step - accuracy: 0.6492 - loss: 0.0767 - val_accuracy: 0.8276 - val_loss: 0.0707 - learning_rate: 5.0000e-04\n",
            "Epoch 82/100\n",
            "24/24 - 0s - 17ms/step - accuracy: 0.6492 - loss: 0.0766 - val_accuracy: 0.8276 - val_loss: 0.0710 - learning_rate: 5.0000e-04\n",
            "Epoch 83/100\n",
            "\n",
            "Epoch 83: ReduceLROnPlateau reducing learning rate to 0.0002500000118743628.\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6492 - loss: 0.0766 - val_accuracy: 0.8276 - val_loss: 0.0697 - learning_rate: 5.0000e-04\n",
            "Epoch 84/100\n",
            "24/24 - 1s - 30ms/step - accuracy: 0.6492 - loss: 0.0765 - val_accuracy: 0.8276 - val_loss: 0.0697 - learning_rate: 2.5000e-04\n",
            "Epoch 85/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6492 - loss: 0.0765 - val_accuracy: 0.8276 - val_loss: 0.0706 - learning_rate: 2.5000e-04\n",
            "Epoch 86/100\n",
            "24/24 - 1s - 27ms/step - accuracy: 0.6492 - loss: 0.0764 - val_accuracy: 0.8276 - val_loss: 0.0695 - learning_rate: 2.5000e-04\n",
            "Epoch 87/100\n",
            "24/24 - 1s - 21ms/step - accuracy: 0.6492 - loss: 0.0763 - val_accuracy: 0.8276 - val_loss: 0.0702 - learning_rate: 2.5000e-04\n",
            "Epoch 88/100\n",
            "24/24 - 1s - 32ms/step - accuracy: 0.6492 - loss: 0.0763 - val_accuracy: 0.8276 - val_loss: 0.0691 - learning_rate: 2.5000e-04\n",
            "Epoch 89/100\n",
            "24/24 - 0s - 17ms/step - accuracy: 0.6492 - loss: 0.0762 - val_accuracy: 0.8276 - val_loss: 0.0701 - learning_rate: 2.5000e-04\n",
            "Epoch 90/100\n",
            "24/24 - 0s - 18ms/step - accuracy: 0.6492 - loss: 0.0762 - val_accuracy: 0.8276 - val_loss: 0.0700 - learning_rate: 2.5000e-04\n",
            "Epoch 91/100\n",
            "24/24 - 1s - 26ms/step - accuracy: 0.6492 - loss: 0.0761 - val_accuracy: 0.8276 - val_loss: 0.0701 - learning_rate: 2.5000e-04\n",
            "Epoch 92/100\n",
            "24/24 - 0s - 17ms/step - accuracy: 0.6492 - loss: 0.0761 - val_accuracy: 0.8276 - val_loss: 0.0694 - learning_rate: 2.5000e-04\n",
            "Epoch 93/100\n",
            "\n",
            "Epoch 93: ReduceLROnPlateau reducing learning rate to 0.0001250000059371814.\n",
            "24/24 - 0s - 17ms/step - accuracy: 0.6492 - loss: 0.0760 - val_accuracy: 0.8276 - val_loss: 0.0695 - learning_rate: 2.5000e-04\n",
            "Epoch 94/100\n",
            "24/24 - 0s - 18ms/step - accuracy: 0.6492 - loss: 0.0760 - val_accuracy: 0.8276 - val_loss: 0.0697 - learning_rate: 1.2500e-04\n",
            "Epoch 95/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6492 - loss: 0.0760 - val_accuracy: 0.8276 - val_loss: 0.0698 - learning_rate: 1.2500e-04\n",
            "Epoch 96/100\n",
            "24/24 - 1s - 27ms/step - accuracy: 0.6492 - loss: 0.0759 - val_accuracy: 0.8276 - val_loss: 0.0697 - learning_rate: 1.2500e-04\n",
            "Epoch 97/100\n",
            "24/24 - 1s - 24ms/step - accuracy: 0.6492 - loss: 0.0759 - val_accuracy: 0.8276 - val_loss: 0.0692 - learning_rate: 1.2500e-04\n",
            "Epoch 98/100\n",
            "\n",
            "Epoch 98: ReduceLROnPlateau reducing learning rate to 6.25000029685907e-05.\n",
            "24/24 - 0s - 17ms/step - accuracy: 0.6492 - loss: 0.0759 - val_accuracy: 0.8276 - val_loss: 0.0697 - learning_rate: 1.2500e-04\n",
            "Epoch 98: early stopping\n",
            "Restoring model weights from the end of the best epoch: 88.\n",
            "CPU times: user 56 s, sys: 10.5 s, total: 1min 6s\n",
            "Wall time: 1min 50s\n"
          ]
        },
        {
          "output_type": "execute_result",
          "data": {
            "text/plain": [
              "<keras.src.callbacks.history.History at 0x7dbdcfc5f0d0>"
            ]
          },
          "metadata": {},
          "execution_count": 21
        }
      ],
      "source": [
        "%%time\n",
        "from imblearn.over_sampling import SMOTE\n",
        "from sklearn.model_selection import train_test_split\n",
        "from tensorflow.keras.callbacks import EarlyStopping, ReduceLROnPlateau\n",
        "\n",
        "# Define early stopping to stop training when validation loss doesn't improve\n",
        "early_stop = EarlyStopping(monitor='val_loss', patience=10, restore_best_weights=True, verbose=1)\n",
        "\n",
        "# Reduce learning rate when validation loss stops improving\n",
        "reduce_lr = ReduceLROnPlateau(monitor='val_loss', factor=0.5, patience=5, verbose=1)\n",
        "\n",
        "# Combine text and numeric features for SMOTE\n",
        "X_combined = np.concatenate([X_text, X_func_rating], axis=1)\n",
        "\n",
        "# Split data before SMOTE to prevent data leakage\n",
        "X_train, X_val, y_train, y_val = train_test_split(X_combined, y_one_hot, test_size=0.1, random_state=42)\n",
        "\n",
        "# Flatten y to 1D for SMOTE\n",
        "y_train_flat = np.argmax(y_train, axis=1)\n",
        "\n",
        "# Apply SMOTE to the training data\n",
        "smote = SMOTE(sampling_strategy='auto', random_state=42)\n",
        "X_resampled, y_resampled = smote.fit_resample(X_train, y_train_flat)\n",
        "\n",
        "# Convert resampled labels back to one-hot encoding\n",
        "y_resampled = tf.keras.utils.to_categorical(y_resampled, num_classes=2)\n",
        "\n",
        "# Split the resampled data back into text and numerical inputs\n",
        "X_resampled_text = X_resampled[:, :X_text.shape[1]]\n",
        "X_resampled_func = X_resampled[:, X_text.shape[1]:]\n",
        "\n",
        "print(\"Before SMOTE:\", X_train.shape, y_train.shape)\n",
        "print(\"After SMOTE:\", X_resampled.shape, y_resampled.shape)\n",
        "\n",
        "# Fit the model on the resampled data\n",
        "model.fit(\n",
        "    {\"text_input\": X_resampled_text, \"func_rating_input\": X_resampled_func},\n",
        "    y_resampled,\n",
        "    epochs=100,\n",
        "    batch_size=16,\n",
        "    validation_data=(\n",
        "        {\"text_input\": X_val[:, :X_text.shape[1]], \"func_rating_input\": X_val[:, X_text.shape[1]:]},\n",
        "        y_val\n",
        "    ),\n",
        "    callbacks=[early_stop, reduce_lr],\n",
        "    verbose=2\n",
        ")\n",
        "# Train the model with regularization and early stopping\n",
        "#model.fit(\n",
        "#    {\"text_input\": X_text, \"func_rating_input\": X_func_rating},\n",
        " #   y_one_hot,\n",
        "  #  epochs=50,\n",
        "  #  batch_size=5,\n",
        "   # validation_split=0.05,\n",
        "    #class_weight=class_weights_dict,\n",
        "    #verbose=2\n",
        "#)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 22,
      "metadata": {
        "id": "DShKlqjy2j3c",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 472
        },
        "outputId": "4748960e-48c2-4bf2-bd49-fde44143188a"
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "<Figure size 640x480 with 1 Axes>"
            ],
            "image/png": "iVBORw0KGgoAAAANSUhEUgAAAjcAAAHHCAYAAABDUnkqAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAPYQAAD2EBqD+naQAASe9JREFUeJzt3Xl4VPXd/vH7zCQzSchGEkhYwo4ssoiAGLCKgrIootK64SO0Vn5a3KBUxaoVrYb6VMUF0bYW9CmUugAuiIisQgEBQRAxLIIgEMKWTBLIJJk5vz+SDBk2QzKZMxner+s6VzJnzvKZEyA33+UcwzRNUwAAAGHCZnUBAAAAgUS4AQAAYYVwAwAAwgrhBgAAhBXCDQAACCuEGwAAEFYINwAAIKwQbgAAQFgh3AAAgLBCuAEQUnbt2iXDMDRt2rRz3nfJkiUyDENLliw563bTpk2TYRjatWtXtWoEENoINwAAIKwQbgAAQFgh3AAAgLBCuAHg56mnnpJhGNq6davuuOMOJSQkqEGDBnriiSdkmqb27NmjoUOHKj4+XmlpaXrhhRdOOUZOTo7uuusupaamKioqSl27dtXbb799yna5ubkaOXKkEhISlJiYqBEjRig3N/e0dX3//ff65S9/qaSkJEVFRalHjx766KOPAvrZX3/9dV144YVyOp1q3LixRo8efUo927Zt07Bhw5SWlqaoqCg1bdpUt956q/Ly8nzbLFiwQJdddpkSExMVGxurdu3a6bHHHgtorQDOLMLqAgCEpltuuUUdOnTQxIkTNXfuXP35z39WUlKS3nzzTV111VX6y1/+ounTp2vcuHHq2bOnLr/8cknS8ePH1bdvX23fvl333XefWrZsqffee08jR45Ubm6uHnzwQUmSaZoaOnSoli9frnvuuUcdOnTQ7NmzNWLEiFNq2bx5s/r06aMmTZro0UcfVb169fTuu+/qhhtu0AcffKAbb7yxxp/3qaee0oQJE9S/f3/de++9ysrK0pQpU7RmzRqtWLFCkZGRKi4u1oABA+R2u3X//fcrLS1Ne/fu1SeffKLc3FwlJCRo8+bNuu6669SlSxc9/fTTcjqd2r59u1asWFHjGgFUkQkAlfzpT38yJZmjRo3yrSstLTWbNm1qGoZhTpw40bf+6NGjZnR0tDlixAjfukmTJpmSzH/961++dcXFxWZGRoYZGxtrulwu0zRNc86cOaYk8/nnn/c7zy9+8QtTkjl16lTf+n79+pmdO3c2i4qKfOu8Xq/Zu3dvs23btr51ixcvNiWZixcvPutnnDp1qinJ3Llzp2mappmTk2M6HA7zmmuuMT0ej2+71157zZRk/vOf/zRN0zTXr19vSjLfe++9Mx77pZdeMiWZBw8ePGsNAGoP3VIATuu3v/2t73u73a4ePXrINE3dddddvvWJiYlq166dfvjhB9+6Tz/9VGlpabrtttt86yIjI/XAAw+ooKBAS5cu9W0XERGhe++91+88999/v18dR44c0aJFi3TzzTcrPz9fhw4d0qFDh3T48GENGDBA27Zt0969e2v0Wb/44gsVFxfroYceks124p/Fu+++W/Hx8Zo7d64kKSEhQZI0f/58HTt27LTHSkxMlCR9+OGH8nq9NaoLQPUQbgCcVrNmzfxeJyQkKCoqSikpKaesP3r0qO/1jz/+qLZt2/qFBEnq0KGD7/2Kr40aNVJsbKzfdu3atfN7vX37dpmmqSeeeEINGjTwW/70pz9JKhvjUxMVNZ18bofDoVatWvneb9mypcaOHat//OMfSklJ0YABAzR58mS/8Ta33HKL+vTpo9/+9rdKTU3VrbfeqnfffZegAwQRY24AnJbdbq/SOqls/ExtqQgF48aN04ABA067TZs2bWrt/Cd74YUXNHLkSH344Yf6/PPP9cADDygzM1OrVq1S06ZNFR0drWXLlmnx4sWaO3euPvvsM/3nP//RVVddpc8///yM1xBA4NByAyCgmjdvrm3btp3SUvH999/73q/4un//fhUUFPhtl5WV5fe6VatWksq6tvr373/aJS4ursY1n+7cxcXF2rlzp+/9Cp07d9bjjz+uZcuW6csvv9TevXv1xhtv+N632Wzq16+fXnzxRX333Xd69tlntWjRIi1evLhGdQKoGsINgIAaPHiwsrOz9Z///Me3rrS0VK+++qpiY2N1xRVX+LYrLS3VlClTfNt5PB69+uqrfsdr2LCh+vbtqzfffFP79+8/5XwHDx6scc39+/eXw+HQK6+84tcK9dZbbykvL0/XXnutJMnlcqm0tNRv386dO8tms8ntdksqGyN0sosuukiSfNsAqF10SwEIqFGjRunNN9/UyJEjtW7dOrVo0ULvv/++VqxYoUmTJvlaWYYMGaI+ffro0Ucf1a5du9SxY0fNmjXLb/xKhcmTJ+uyyy5T586ddffdd6tVq1Y6cOCAVq5cqZ9++knffPNNjWpu0KCBxo8frwkTJmjgwIG6/vrrlZWVpddff109e/bUHXfcIUlatGiR7rvvPv3qV7/SBRdcoNLSUv3f//2f7Ha7hg0bJkl6+umntWzZMl177bVq3ry5cnJy9Prrr6tp06a67LLLalQngKoh3AAIqOjoaC1ZskSPPvqo3n77bblcLrVr105Tp07VyJEjfdvZbDZ99NFHeuihh/Svf/1LhmHo+uuv1wsvvKBu3br5HbNjx45au3atJkyYoGnTpunw4cNq2LChunXrpieffDIgdT/11FNq0KCBXnvtNY0ZM0ZJSUkaNWqUnnvuOUVGRkqSunbtqgEDBujjjz/W3r17FRMTo65du2revHm69NJLJUnXX3+9du3apX/+8586dOiQUlJSdMUVV2jChAm+2VYAapdh1uZIQAAAgCBjzA0AAAgrhBsAABBWCDcAACCsEG4AAEBYIdwAAICwQrgBAABhJezvc+P1erVv3z7FxcXJMAyrywEAAFVgmqby8/PVuHHjUx7E+3PCPtzs27dP6enpVpcBAACqYc+ePWratOk57RP24abiVu979uxRfHy8xdUAAICqcLlcSk9Pr9aDccM+3FR0RcXHxxNuAACoY6ozpIQBxQAAIKwQbgAAQFgh3AAAgLAS9mNuqsrj8aikpMTqMuokh8NxztP0AACoLed9uDFNU9nZ2crNzbW6lDrLZrOpZcuWcjgcVpcCAADhpiLYNGzYUDExMdzo7xxV3CRx//79atasGdcPAGC58zrceDweX7BJTk62upw6q0GDBtq3b59KS0sVGRlpdTkAgPPceT1QomKMTUxMjMWV1G0V3VEej8fiSgAAOM/DTQW6UmqG6wcACCWEGwAAEFYIN1CLFi00adIkq8sAACAgzusBxXVZ3759ddFFFwUklKxZs0b16tWreVEAAIQAwk01lXq98npN2QxDEfbQawAzTVMej0cRET//I27QoEEQKgIAIDhC77dyHZGdW6Tvs/N1pLA46OceOXKkli5dqpdfflmGYcgwDE2bNk2GYWjevHnq3r27nE6nli9frh07dmjo0KFKTU1VbGysevbsqS+++MLveCd3SxmGoX/84x+68cYbFRMTo7Zt2+qjjz4K8qcEAKB6CDeVmKapY8WlVVqKSrwqKvGosNhT5X3OtpimWeU6X375ZWVkZOjuu+/W/v37tX//fqWnp0uSHn30UU2cOFFbtmxRly5dVFBQoMGDB2vhwoVav369Bg4cqCFDhmj37t1nPceECRN08803a+PGjRo8eLCGDx+uI0eO1Oj6AgAQDCHTLTVx4kSNHz9eDz74oK8VoaioSL///e81c+ZMud1uDRgwQK+//rpSU1NrpYbjJR51fHJ+rRz753z39ADFOKr240hISJDD4VBMTIzS0tIkSd9//70k6emnn9bVV1/t2zYpKUldu3b1vX7mmWc0e/ZsffTRR7rvvvvOeI6RI0fqtttukyQ999xzeuWVV/TVV19p4MCB5/zZAAAIppBouVmzZo3efPNNdenSxW/9mDFj9PHHH+u9997T0qVLtW/fPt10000WVVk39OjRw+91QUGBxo0bpw4dOigxMVGxsbHasmXLz7bcVP5Z1KtXT/Hx8crJyamVmgEACCTLW24KCgo0fPhw/f3vf9ef//xn3/q8vDy99dZbmjFjhq666ipJ0tSpU9WhQwetWrVKl156acBriY6067unB1Rp2wMutw7mFykpxqnG9aMCcu5AOHnW07hx47RgwQL99a9/VZs2bRQdHa1f/vKXKi4++1ihkx+jYBiGvF5vQGoEAKA2WR5uRo8erWuvvVb9+/f3Czfr1q1TSUmJ+vfv71vXvn17NWvWTCtXrjxjuHG73XK73b7XLperyrUYhlHlrqF6jlLlR9oVFWmr8j6B5HA4qvS4gxUrVmjkyJG68cYbJZWFyV27dtVydQAAWMfScDNz5kx9/fXXWrNmzSnvZWdny+FwKDEx0W99amqqsrOzz3jMzMxMTZgwIdClnqLikQNVHwYcWC1atNDq1au1a9cuxcbGnrFVpW3btpo1a5aGDBkiwzD0xBNP0AIDAAhrlo252bNnjx588EFNnz5dUVE179apMH78eOXl5fmWPXv2BOzYlVU8Tsl7DrOcAmncuHGy2+3q2LGjGjRocMYxNC+++KLq16+v3r17a8iQIRowYIAuvvjiIFcLAEDwWNZys27dOuXk5Pj9ovV4PFq2bJlee+01zZ8/X8XFxcrNzfVrvTlw4IBvhtDpOJ1OOZ3O2ixdklTxqEiLso0uuOACrVy50m/dyJEjT9muRYsWWrRokd+60aNH+70+uZvqdNPSc3Nzq1UnAADBZlm46devnzZt2uS37te//rXat2+vRx55ROnp6YqMjNTChQs1bNgwSVJWVpZ2796tjIwMK0r2Y3W3FAAAOD3Lwk1cXJw6derkt65evXpKTk72rb/rrrs0duxYJSUlKT4+Xvfff78yMjJqZabUubKVN92cy833AABA7bN8ttTZvPTSS7LZbBo2bJjfTfxCwYkxN9bWAQAA/IVUuFmyZInf66ioKE2ePFmTJ0+2pqCzMFTRLUW6AQAglITEHYrrIsPXLWVtHQAAwB/hpppsFQOKCTcAAIQUwk01nZgKTroBACCUEG6qydctZW0ZAADgJISbaqq4z41VdygGAACnR7ippro+oLhFixaaNGmS1WUAABBwhJtq8k0Fr6PhBgCAcEW4qSbfHYplMqgYAIAQQrippopuKSn4rTd/+9vf1LhxY3m9Xr/1Q4cO1W9+8xvt2LFDQ4cOVWpqqmJjY9WzZ0998cUXwS0SAACLEG4qM02puLBKi1FyzLeYxQVV3u+MyzkkpF/96lc6fPiwFi9e7Ft35MgRffbZZxo+fLgKCgo0ePBgLVy4UOvXr9fAgQM1ZMgQ7d69uzauGgAAISWkHr9guZJj0nONq7SpTVLnQJ77sX2So16VNq1fv74GDRqkGTNmqF+/fpKk999/XykpKbryyitls9nUtWtX3/bPPPOMZs+erY8++kj33XdfIKsGACDk0HJTRw0fPlwffPCB3G63JGn69Om69dZbZbPZVFBQoHHjxqlDhw5KTExUbGystmzZQssNAOC8QMtNZZExZS0oVbR5n0te09QFqbFyRthrfu5zMGTIEJmmqblz56pnz5768ssv9dJLL0mSxo0bpwULFuivf/2r2rRpo+joaP3yl79UcXFxzWoEAKAOINxUZhhV7hqSJMNRKtNryoysJ0XWMNyco6ioKN10002aPn26tm/frnbt2uniiy+WJK1YsUIjR47UjTfeKEkqKCjQrl27glofAABWIdzUQNldiq2bCj58+HBdd9112rx5s+644w7f+rZt22rWrFkaMmSIDMPQE088ccrMKgAAwhVjbmrgxMMzrTn/VVddpaSkJGVlZen222/3rX/xxRdVv3599e7dW0OGDNGAAQN8rToAAIQ7Wm5qwPd8KYvOb7PZtG/fqWOEWrRooUWLFvmtGz16tN9ruqkAAOGKlpsaOPF8Ke5QDABA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Qw895FvH9a4de/fu1R133KHk5GRFR0erc+fOWrt2re990zT15JNPqlGjRoqOjlb//v21bds2Cyuu2zwej5544gm1bNlS0dHRat26tZ555hm/ZxdxzWtm2bJlGjJkiBo3bizDMDRnzhy/96tyfY8cOaLhw4crPj5eiYmJuuuuu1RQUHBuhZg4ZzNnzjQdDof5z3/+09y8ebN59913m4mJieaBAwesLi0sDBgwwJw6dar57bffmhs2bDAHDx5sNmvWzCwoKPBtc88995jp6enmwoULzbVr15qXXnqp2bt3bwurDg9fffWV2aJFC7NLly7mgw8+6FvP9Q68I0eOmM2bNzdHjhxprl692vzhhx/M+fPnm9u3b/dtM3HiRDMhIcGcM2eO+c0335jXX3+92bJlS/P48eMWVl53Pfvss2ZycrL5ySefmDt37jTfe+89MzY21nz55Zd923DNa+bTTz81//jHP5qzZs0yJZmzZ8/2e78q13fgwIFm165dzVWrVplffvml2aZNG/O22247pzoIN9VwySWXmKNHj/a99ng8ZuPGjc3MzEwLqwpfOTk5piRz6dKlpmmaZm5urhkZGWm+9957vm22bNliSjJXrlxpVZl1Xn5+vtm2bVtzwYIF5hVXXOELN1zv2vHII4+Yl1122Rnf93q9Zlpamvm///u/vnW5ubmm0+k0//3vfwejxLBz7bXXmr/5zW/81t10003m8OHDTdPkmgfayeGmKtf3u+++MyWZa9as8W0zb9480zAMc+/evVU+N91S56i4uFjr1q1T//79fetsNpv69++vlStXWlhZ+MrLy5MkJSUlSZLWrVunkpISv59B+/bt1axZM34GNTB69Ghde+21ftdV4nrXlo8++kg9evTQr371KzVs2FDdunXT3//+d9/7O3fuVHZ2tt91T0hIUK9evbju1dS7d28tXLhQW7dulSR98803Wr58uQYNGiSJa17bqnJ9V65cqcTERPXo0cO3Tf/+/WWz2bR69eoqnyvsH5wZaIcOHZLH41Fqaqrf+tTUVH3//fcWVRW+vF6vHnroIfXp00edOnWSJGVnZ8vhcCgxMdFv29TUVGVnZ1tQZd03c+ZMff3111qzZs0p73G9a8cPP/ygKVOmaOzYsXrssce0Zs0aPfDAA3I4HBoxYoTv2p7u3xque/U8+uijcrlcat++vex2uzwej5599lkNHz5ckrjmtawq1zc7O1sNGzb0ez8iIkJJSUnn9DMg3CCkjR49Wt9++62WL19udSlha8+ePXrwwQe1YMECRUVFWV3OecPr9apHjx567rnnJEndunXTt99+qzfeeEMjRoywuLrw9O6772r69OmaMWOGLrzwQm3YsEEPPfSQGjduzDUPM3RLnaOUlBTZ7fZTZoocOHBAaWlpFlUVnu677z598sknWrx4sZo2bepbn5aWpuLiYuXm5vptz8+getatW6ecnBxdfPHFioiIUEREhJYuXapXXnlFERERSk1N5XrXgkaNGqljx45+6zp06KDdu3dLku/a8m9N4PzhD3/Qo48+qltvvVWdO3fW//zP/2jMmDHKzMyUxDWvbVW5vmlpacrJyfF7v7S0VEeOHDmnnwHh5hw5HA51795dCxcu9K3zer1auHChMjIyLKwsfJimqfvuu0+zZ8/WokWL1LJlS7/3u3fvrsjISL+fQVZWlnbv3s3PoBr69eunTZs2acOGDb6lR48eGj58uO97rnfg9enT55RbHGzdulXNmzeXJLVs2VJpaWl+193lcmn16tVc92o6duyYbDb/X3t2u11er1cS17y2VeX6ZmRkKDc3V+vWrfNts2jRInm9XvXq1avqJ6vxcOjz0MyZM02n02lOmzbN/O6778xRo0aZiYmJZnZ2ttWlhYV7773XTEhIMJcsWWLu37/ftxw7dsy3zT333GM2a9bMXLRokbl27VozIyPDzMjIsLDq8FJ5tpRpcr1rw1dffWVGRESYzz77rLlt2zZz+vTpZkxMjPmvf/3Lt83EiRPNxMRE88MPPzQ3btxoDh06lGnJNTBixAizSZMmvqngs2bNMlNSUsyHH37Ytw3XvGby8/PN9evXm+vXrzclmS+++KK5fv1688cffzRNs2rXd+DAgWa3bt3M1atXm8uXLzfbtm3LVPBgefXVV81mzZqZDofDvOSSS8xVq1ZZXVLYkHTaZerUqb5tjh8/bv7ud78z69evb8bExJg33nijuX//fuuKDjMnhxuud+34+OOPzU6dOplOp9Ns3769+be//c3vfa/Xaz7xxBNmamqq6XQ6zX79+plZWVkWVVv3uVwu88EHHzSbNWtmRkVFma1atTL/+Mc/mm6327cN17xmFi9efNp/v0eMGGGaZtWu7+HDh83bbrvNjI2NNePj481f//rXZn5+/jnVYZhmpVszAgAA1HGMuQEAAGGFcAMAAMIK4QYAAIQVwg0AAAgrhBsAABBWCDcAACCsEG4AAEBYIdwAOO8sWbJEhmGc8rwsAOGBcAMAAMIK4QYAAIQVwg2AoPN6vcrMzFTLli0VHR2trl276v3335d0osto7ty56tKli6KionTppZfq22+/9TvGBx98oAsvvFBOp1MtWrTQCy+84Pe+2+3WI488ovT0dDmdTrVp00ZvvfWW3zbr1q1Tjx49FBMTo969e5/ylG4AdRPhBkDQZWZm6p133tEbb7yhzZs3a8yYMbrjjju0dOlS3zZ/+MMf9MILL2jNmjVq0KCBhgwZopKSEklloeTmm2/Wrbfeqk2bNumpp57SE088oWnTpvn2v/POO/Xvf/9br7zyirZs2aI333xTsbGxfnX88Y9/1AsvvKC1a9cqIiJCv/nNb4Ly+QHULh6cCSCo3G63kpKS9MUXXygjI8O3/re//a2OHTumUaNG6corr9TMmTN1yy23SJKOHDmipk2batq0abr55ps1fPhwHTx4UJ9//rlv/4cfflhz587V5s2btXXrVrVr104LFixQ//79T6lhyZIluvLKK/XFF1+oX79+kqRPP/1U1157rY4fP66oqKhavgoAahMtNwCCavv27Tp27JiuvvpqxcbG+pZ33nlHO3bs8G1XOfgkJSWpXbt22rJliyRpy5Yt6tOnj99x+/Tpo23btsnj8WjDhg2y2+264oorzlpLly5dfN83atRIkpSTk1PjzwjAWhFWFwDg/FJQUCBJmjt3rpo0aeL3ntPp9As41RUdHV2l7SIjI33fG4YhqWw8EIC6jZYbAEHVsWNHOZ1O7d69W23atPFb0tPTfdutWrXK9/3Ro0e1detWdejQQZLUoUMHrVixwu+4K1as0AUXXCC73a7OnTvL6/X6jeEBcP6g5QZAUMXFxWncuHEaM2aMvF6vLrvsMuXl5WnFihWKj49X8+bNJUlPP/20kpOTlZqaqj/+8Y9KSUnRDTfcIEn6/e9/r549e+qZZ57RLbfcopUrV+q1117T66+/Lklq0aKFRowYod/85jd65ZVX1LVrV/3444/KycnRzTffbNVHBxAkhBsAQffMM8+oQYMGyszM1A8//KDExERdfPHFeuyxx3zdQhMnTtSDDz6obdu26aKLLtLHH38sh8MhSbr44ov17rvv6sknn9QzzzyjRo0a6emnn9bIkSN955gyZYoee+wx/e53v9Phw4fVrFkzPfbYY1Z8XABBxmwpACGlYibT0aNHlZiYaHU5AOogxtwAAICwQrgBAABhhW4pAAAQVmi5AQAAYYVwAwAAwgrhBgAAhBXCDQAACCuEGwAAEFYINwAAIKwQbgAAQFgh3AAAgLBCuAEAAGHl/wOUq+zfL6LBMQAAAABJRU5ErkJggg==\n"
          },
          "metadata": {}
        }
      ],
      "source": [
        "# Plot error\n",
        "import matplotlib.pyplot as plt\n",
        "\n",
        "plt.plot(model.history.history['loss'])\n",
        "plt.plot(model.history.history['val_loss'])\n",
        "plt.title('model loss')\n",
        "plt.ylabel('loss')\n",
        "plt.xlabel('epoch')\n",
        "plt.legend(['train', 'val'], loc='upper left')\n",
        "plt.show()"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": 23,
      "metadata": {
        "id": "PSdlbIL6PB8S",
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 1000
        },
        "outputId": "b81a78da-1410-4a9a-99c4-738d04e6be20"
      },
      "outputs": [
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "\u001b[1mModel: \"functional_2\"\u001b[0m\n"
            ],
            "text/html": [
              "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\">Model: \"functional_2\"</span>\n",
              "</pre>\n"
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "\n",
              "\u001b[1m \u001b[0m\u001b[1mLayer (type)             \u001b[0m\u001b[1m \u001b[0m\u001b[1m \u001b[0m\u001b[1mOutput Shape          \u001b[0m\u001b[1m \u001b[0m\u001b[1m \u001b[0m\u001b[1m       Param #\u001b[0m\u001b[1m \u001b[0m\u001b[1m \u001b[0m\u001b[1mConnected to          \u001b[0m\u001b[1m \u001b[0m\n",
              "\n",
              " text_input (\u001b[38;5;33mInputLayer\u001b[0m)    (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)                          \u001b[38;5;34m0\u001b[0m  -                      \n",
              "\n",
              " embedding_2 (\u001b[38;5;33mEmbedding\u001b[0m)    (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m, \u001b[38;5;34m128\u001b[0m)                 \u001b[38;5;34m3,840\u001b[0m  text_input[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]       \n",
              "\n",
              " flatten_2 (\u001b[38;5;33mFlatten\u001b[0m)        (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m65536\u001b[0m)                        \u001b[38;5;34m0\u001b[0m  embedding_2[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]      \n",
              "\n",
              " dense_6 (\u001b[38;5;33mDense\u001b[0m)            (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)                 \u001b[38;5;34m33,554,944\u001b[0m  flatten_2[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]        \n",
              "\n",
              " batch_normalization_4      (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)                      \u001b[38;5;34m2,048\u001b[0m  dense_6[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]          \n",
              " (\u001b[38;5;33mBatchNormalization\u001b[0m)                                                                      \n",
              "\n",
              " dropout_4 (\u001b[38;5;33mDropout\u001b[0m)        (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m512\u001b[0m)                          \u001b[38;5;34m0\u001b[0m  batch_normalization_4 \n",
              "\n",
              " dense_7 (\u001b[38;5;33mDense\u001b[0m)            (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m256\u001b[0m)                    \u001b[38;5;34m131,328\u001b[0m  dropout_4[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]        \n",
              "\n",
              " batch_normalization_5      (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m256\u001b[0m)                      \u001b[38;5;34m1,024\u001b[0m  dense_7[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]          \n",
              " (\u001b[38;5;33mBatchNormalization\u001b[0m)                                                                      \n",
              "\n",
              " dropout_5 (\u001b[38;5;33mDropout\u001b[0m)        (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m256\u001b[0m)                          \u001b[38;5;34m0\u001b[0m  batch_normalization_5 \n",
              "\n",
              " dense_8 (\u001b[38;5;33mDense\u001b[0m)            (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m128\u001b[0m)                     \u001b[38;5;34m32,896\u001b[0m  dropout_5[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]        \n",
              "\n",
              " batch_normalization_6      (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m128\u001b[0m)                        \u001b[38;5;34m512\u001b[0m  dense_8[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]          \n",
              " (\u001b[38;5;33mBatchNormalization\u001b[0m)                                                                      \n",
              "\n",
              " dropout_6 (\u001b[38;5;33mDropout\u001b[0m)        (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m128\u001b[0m)                          \u001b[38;5;34m0\u001b[0m  batch_normalization_6 \n",
              "\n",
              " dense_9 (\u001b[38;5;33mDense\u001b[0m)            (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m64\u001b[0m)                       \u001b[38;5;34m8,256\u001b[0m  dropout_6[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]        \n",
              "\n",
              " batch_normalization_7      (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m64\u001b[0m)                         \u001b[38;5;34m256\u001b[0m  dense_9[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]          \n",
              " (\u001b[38;5;33mBatchNormalization\u001b[0m)                                                                      \n",
              "\n",
              " dropout_7 (\u001b[38;5;33mDropout\u001b[0m)        (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m64\u001b[0m)                           \u001b[38;5;34m0\u001b[0m  batch_normalization_7 \n",
              "\n",
              " dense_10 (\u001b[38;5;33mDense\u001b[0m)           (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m32\u001b[0m)                       \u001b[38;5;34m2,080\u001b[0m  dropout_7[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]        \n",
              "\n",
              " batch_normalization_8      (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m32\u001b[0m)                         \u001b[38;5;34m128\u001b[0m  dense_10[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]         \n",
              " (\u001b[38;5;33mBatchNormalization\u001b[0m)                                                                      \n",
              "\n",
              " dropout_8 (\u001b[38;5;33mDropout\u001b[0m)        (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m32\u001b[0m)                           \u001b[38;5;34m0\u001b[0m  batch_normalization_8 \n",
              "\n",
              " dense_11 (\u001b[38;5;33mDense\u001b[0m)           (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m16\u001b[0m)                         \u001b[38;5;34m528\u001b[0m  dropout_8[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]        \n",
              "\n",
              " batch_normalization_9      (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m16\u001b[0m)                          \u001b[38;5;34m64\u001b[0m  dense_11[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]         \n",
              " (\u001b[38;5;33mBatchNormalization\u001b[0m)                                                                      \n",
              "\n",
              " dropout_9 (\u001b[38;5;33mDropout\u001b[0m)        (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m16\u001b[0m)                           \u001b[38;5;34m0\u001b[0m  batch_normalization_9 \n",
              "\n",
              " dense_12 (\u001b[38;5;33mDense\u001b[0m)           (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m8\u001b[0m)                          \u001b[38;5;34m136\u001b[0m  dropout_9[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]        \n",
              "\n",
              " batch_normalization_10     (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m8\u001b[0m)                           \u001b[38;5;34m32\u001b[0m  dense_12[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]         \n",
              " (\u001b[38;5;33mBatchNormalization\u001b[0m)                                                                      \n",
              "\n",
              " dropout_10 (\u001b[38;5;33mDropout\u001b[0m)       (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m8\u001b[0m)                            \u001b[38;5;34m0\u001b[0m  batch_normalization_1 \n",
              "\n",
              " dense_13 (\u001b[38;5;33mDense\u001b[0m)           (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m4\u001b[0m)                           \u001b[38;5;34m36\u001b[0m  dropout_10[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]       \n",
              "\n",
              " batch_normalization_11     (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m4\u001b[0m)                           \u001b[38;5;34m16\u001b[0m  dense_13[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]         \n",
              " (\u001b[38;5;33mBatchNormalization\u001b[0m)                                                                      \n",
              "\n",
              " dropout_11 (\u001b[38;5;33mDropout\u001b[0m)       (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m4\u001b[0m)                            \u001b[38;5;34m0\u001b[0m  batch_normalization_1 \n",
              "\n",
              " dense_14 (\u001b[38;5;33mDense\u001b[0m)           (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m2\u001b[0m)                           \u001b[38;5;34m10\u001b[0m  dropout_11[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]       \n",
              "\n",
              " batch_normalization_12     (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m2\u001b[0m)                            \u001b[38;5;34m8\u001b[0m  dense_14[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]         \n",
              " (\u001b[38;5;33mBatchNormalization\u001b[0m)                                                                      \n",
              "\n",
              " dropout_12 (\u001b[38;5;33mDropout\u001b[0m)       (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m2\u001b[0m)                            \u001b[38;5;34m0\u001b[0m  batch_normalization_1 \n",
              "\n",
              " dense_15 (\u001b[38;5;33mDense\u001b[0m)           (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m1\u001b[0m)                            \u001b[38;5;34m3\u001b[0m  dropout_12[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]       \n",
              "\n",
              " batch_normalization_13     (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m1\u001b[0m)                            \u001b[38;5;34m4\u001b[0m  dense_15[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]         \n",
              " (\u001b[38;5;33mBatchNormalization\u001b[0m)                                                                      \n",
              "\n",
              " func_rating_input          (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m1\u001b[0m)                            \u001b[38;5;34m0\u001b[0m  -                      \n",
              " (\u001b[38;5;33mInputLayer\u001b[0m)                                                                              \n",
              "\n",
              " dropout_13 (\u001b[38;5;33mDropout\u001b[0m)       (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m1\u001b[0m)                            \u001b[38;5;34m0\u001b[0m  batch_normalization_1 \n",
              "\n",
              " dense_16 (\u001b[38;5;33mDense\u001b[0m)           (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m32\u001b[0m)                          \u001b[38;5;34m64\u001b[0m  func_rating_input[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m\u001b[0m \n",
              "\n",
              " concatenate_2              (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m33\u001b[0m)                           \u001b[38;5;34m0\u001b[0m  dropout_13[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m],      \n",
              " (\u001b[38;5;33mConcatenate\u001b[0m)                                                      dense_16[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]         \n",
              "\n",
              " output (\u001b[38;5;33mDense\u001b[0m)             (\u001b[38;5;45mNone\u001b[0m, \u001b[38;5;34m2\u001b[0m)                           \u001b[38;5;34m68\u001b[0m  concatenate_2[\u001b[38;5;34m0\u001b[0m][\u001b[38;5;34m0\u001b[0m]    \n",
              "\n"
            ],
            "text/html": [
              "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\">\n",
              "<span style=\"font-weight: bold\"> Layer (type)              </span><span style=\"font-weight: bold\"> Output Shape           </span><span style=\"font-weight: bold\">        Param # </span><span style=\"font-weight: bold\"> Connected to           </span>\n",
              "\n",
              " text_input (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">InputLayer</span>)    (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)                          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>  -                      \n",
              "\n",
              " embedding_2 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Embedding</span>)    (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">128</span>)                 <span style=\"color: #00af00; text-decoration-color: #00af00\">3,840</span>  text_input[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]       \n",
              "\n",
              " flatten_2 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Flatten</span>)        (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">65536</span>)                        <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>  embedding_2[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]      \n",
              "\n",
              " dense_6 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)            (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)                 <span style=\"color: #00af00; text-decoration-color: #00af00\">33,554,944</span>  flatten_2[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]        \n",
              "\n",
              " batch_normalization_4      (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)                      <span style=\"color: #00af00; text-decoration-color: #00af00\">2,048</span>  dense_6[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]          \n",
              " (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">BatchNormalization</span>)                                                                      \n",
              "\n",
              " dropout_4 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dropout</span>)        (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>)                          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>  batch_normalization_4 \n",
              "\n",
              " dense_7 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)            (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">256</span>)                    <span style=\"color: #00af00; text-decoration-color: #00af00\">131,328</span>  dropout_4[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]        \n",
              "\n",
              " batch_normalization_5      (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">256</span>)                      <span style=\"color: #00af00; text-decoration-color: #00af00\">1,024</span>  dense_7[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]          \n",
              " (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">BatchNormalization</span>)                                                                      \n",
              "\n",
              " dropout_5 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dropout</span>)        (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">256</span>)                          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>  batch_normalization_5 \n",
              "\n",
              " dense_8 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)            (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">128</span>)                     <span style=\"color: #00af00; text-decoration-color: #00af00\">32,896</span>  dropout_5[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]        \n",
              "\n",
              " batch_normalization_6      (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">128</span>)                        <span style=\"color: #00af00; text-decoration-color: #00af00\">512</span>  dense_8[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]          \n",
              " (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">BatchNormalization</span>)                                                                      \n",
              "\n",
              " dropout_6 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dropout</span>)        (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">128</span>)                          <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>  batch_normalization_6 \n",
              "\n",
              " dense_9 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)            (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">64</span>)                       <span style=\"color: #00af00; text-decoration-color: #00af00\">8,256</span>  dropout_6[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]        \n",
              "\n",
              " batch_normalization_7      (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">64</span>)                         <span style=\"color: #00af00; text-decoration-color: #00af00\">256</span>  dense_9[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]          \n",
              " (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">BatchNormalization</span>)                                                                      \n",
              "\n",
              " dropout_7 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dropout</span>)        (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">64</span>)                           <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>  batch_normalization_7 \n",
              "\n",
              " dense_10 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)           (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">32</span>)                       <span style=\"color: #00af00; text-decoration-color: #00af00\">2,080</span>  dropout_7[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]        \n",
              "\n",
              " batch_normalization_8      (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">32</span>)                         <span style=\"color: #00af00; text-decoration-color: #00af00\">128</span>  dense_10[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]         \n",
              " (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">BatchNormalization</span>)                                                                      \n",
              "\n",
              " dropout_8 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dropout</span>)        (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">32</span>)                           <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>  batch_normalization_8 \n",
              "\n",
              " dense_11 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)           (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">16</span>)                         <span style=\"color: #00af00; text-decoration-color: #00af00\">528</span>  dropout_8[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]        \n",
              "\n",
              " batch_normalization_9      (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">16</span>)                          <span style=\"color: #00af00; text-decoration-color: #00af00\">64</span>  dense_11[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]         \n",
              " (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">BatchNormalization</span>)                                                                      \n",
              "\n",
              " dropout_9 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dropout</span>)        (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">16</span>)                           <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>  batch_normalization_9 \n",
              "\n",
              " dense_12 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)           (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">8</span>)                          <span style=\"color: #00af00; text-decoration-color: #00af00\">136</span>  dropout_9[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]        \n",
              "\n",
              " batch_normalization_10     (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">8</span>)                           <span style=\"color: #00af00; text-decoration-color: #00af00\">32</span>  dense_12[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]         \n",
              " (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">BatchNormalization</span>)                                                                      \n",
              "\n",
              " dropout_10 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dropout</span>)       (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">8</span>)                            <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>  batch_normalization_1 \n",
              "\n",
              " dense_13 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)           (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">4</span>)                           <span style=\"color: #00af00; text-decoration-color: #00af00\">36</span>  dropout_10[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]       \n",
              "\n",
              " batch_normalization_11     (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">4</span>)                           <span style=\"color: #00af00; text-decoration-color: #00af00\">16</span>  dense_13[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]         \n",
              " (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">BatchNormalization</span>)                                                                      \n",
              "\n",
              " dropout_11 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dropout</span>)       (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">4</span>)                            <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>  batch_normalization_1 \n",
              "\n",
              " dense_14 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)           (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">2</span>)                           <span style=\"color: #00af00; text-decoration-color: #00af00\">10</span>  dropout_11[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]       \n",
              "\n",
              " batch_normalization_12     (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">2</span>)                            <span style=\"color: #00af00; text-decoration-color: #00af00\">8</span>  dense_14[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]         \n",
              " (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">BatchNormalization</span>)                                                                      \n",
              "\n",
              " dropout_12 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dropout</span>)       (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">2</span>)                            <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>  batch_normalization_1 \n",
              "\n",
              " dense_15 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)           (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">1</span>)                            <span style=\"color: #00af00; text-decoration-color: #00af00\">3</span>  dropout_12[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]       \n",
              "\n",
              " batch_normalization_13     (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">1</span>)                            <span style=\"color: #00af00; text-decoration-color: #00af00\">4</span>  dense_15[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]         \n",
              " (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">BatchNormalization</span>)                                                                      \n",
              "\n",
              " func_rating_input          (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">1</span>)                            <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>  -                      \n",
              " (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">InputLayer</span>)                                                                              \n",
              "\n",
              " dropout_13 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dropout</span>)       (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">1</span>)                            <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>  batch_normalization_1 \n",
              "\n",
              " dense_16 (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)           (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">32</span>)                          <span style=\"color: #00af00; text-decoration-color: #00af00\">64</span>  func_rating_input[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\"></span> \n",
              "\n",
              " concatenate_2              (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">33</span>)                           <span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>  dropout_13[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>],      \n",
              " (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Concatenate</span>)                                                      dense_16[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]         \n",
              "\n",
              " output (<span style=\"color: #0087ff; text-decoration-color: #0087ff\">Dense</span>)             (<span style=\"color: #00d7ff; text-decoration-color: #00d7ff\">None</span>, <span style=\"color: #00af00; text-decoration-color: #00af00\">2</span>)                           <span style=\"color: #00af00; text-decoration-color: #00af00\">68</span>  concatenate_2[<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>][<span style=\"color: #00af00; text-decoration-color: #00af00\">0</span>]    \n",
              "\n",
              "</pre>\n"
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "\u001b[1m Total params: \u001b[0m\u001b[38;5;34m101,210,753\u001b[0m (386.09 MB)\n"
            ],
            "text/html": [
              "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Total params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">101,210,753</span> (386.09 MB)\n",
              "</pre>\n"
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "\u001b[1m Trainable params: \u001b[0m\u001b[38;5;34m33,736,235\u001b[0m (128.69 MB)\n"
            ],
            "text/html": [
              "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">33,736,235</span> (128.69 MB)\n",
              "</pre>\n"
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "\u001b[1m Non-trainable params: \u001b[0m\u001b[38;5;34m2,046\u001b[0m (7.99 KB)\n"
            ],
            "text/html": [
              "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Non-trainable params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">2,046</span> (7.99 KB)\n",
              "</pre>\n"
            ]
          },
          "metadata": {}
        },
        {
          "output_type": "display_data",
          "data": {
            "text/plain": [
              "\u001b[1m Optimizer params: \u001b[0m\u001b[38;5;34m67,472,472\u001b[0m (257.39 MB)\n"
            ],
            "text/html": [
              "<pre style=\"white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace\"><span style=\"font-weight: bold\"> Optimizer params: </span><span style=\"color: #00af00; text-decoration-color: #00af00\">67,472,472</span> (257.39 MB)\n",
              "</pre>\n"
            ]
          },
          "metadata": {}
        }
      ],
      "source": [
        "# Display the model summary\n",
        "model.summary()"
      ]
    },
    {
      "cell_type": "code",
      "source": [
        "from sklearn.metrics import classification_report\n",
        "import numpy as np\n",
        "\n",
        "# Predict on the validation set\n",
        "val_predictions = model.predict(\n",
        "    {\"text_input\": X_val[:, :X_text.shape[1]], \"func_rating_input\": X_val[:, X_text.shape[1]:]}\n",
        ")\n",
        "\n",
        "# Convert one-hot encoded predictions to class labels\n",
        "predicted_labels = np.argmax(val_predictions, axis=1)\n",
        "true_labels = np.argmax(y_val, axis=1)\n",
        "\n",
        "# Generate the classification report\n",
        "report = classification_report(true_labels, predicted_labels, target_names=['Class 0', 'Class 1'])\n",
        "print(\"Classification Report:\\n\", report)"
      ],
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "aCVx0IXogc4i",
        "outputId": "5e84a911-23f0-4e80-da22-e7896d72b736"
      },
      "execution_count": 24,
      "outputs": [
        {
          "output_type": "stream",
          "name": "stdout",
          "text": [
            "\u001b[1m1/1\u001b[0m \u001b[32m\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 2s/step\n",
            "Classification Report:\n",
            "               precision    recall  f1-score   support\n",
            "\n",
            "     Class 0       0.88      0.92      0.90        24\n",
            "     Class 1       0.50      0.40      0.44         5\n",
            "\n",
            "    accuracy                           0.83        29\n",
            "   macro avg       0.69      0.66      0.67        29\n",
            "weighted avg       0.81      0.83      0.82        29\n",
            "\n"
          ]
        }
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "FVAx30lWTtQd"
      },
      "source": [
        "## Create Repo on HF"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "z965EE9wRMuN"
      },
      "outputs": [],
      "source": [
        "! pip install --upgrade huggingface_hub"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "SmhMVs-BRZ5f"
      },
      "outputs": [],
      "source": [
        "from huggingface_hub import HfApi\n",
        "\n",
        "hf_username = \"eagle0504\"  # Replace with your Hugging Face username\n",
        "repo_name = \"my-tf-nn-model-v7\"  # Change this as needed\n",
        "repo_id = f\"{hf_username}/{repo_name}\"\n",
        "\n",
        "api = HfApi()\n",
        "\n",
        "# Create the repository\n",
        "api.create_repo(repo_id=repo_id, exist_ok=True)  # exist_ok=True prevents errors if the repo already exists\n",
        "\n",
        "print(f\"Repository created: https://huggingface.co/{repo_id}\")"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "oLT-_HepTvTH"
      },
      "source": [
        "## Push Artifacts on HF"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "JqH2HkwUPZ9t"
      },
      "outputs": [],
      "source": [
        "import pickle\n",
        "import os\n",
        "from huggingface_hub import HfApi\n",
        "import tensorflow as tf\n",
        "from tensorflow.keras.preprocessing.text import Tokenizer\n",
        "\n",
        "# Define save directory\n",
        "model_dir = \"./saved_model\"\n",
        "os.makedirs(model_dir, exist_ok=True)\n",
        "\n",
        "# Save the model\n",
        "model_path = os.path.join(model_dir, \"model.keras\")\n",
        "model.save(model_path)\n",
        "\n",
        "# Save the tokenizer as a pickle file\n",
        "tokenizer_path = os.path.join(model_dir, \"tokenizer.pkl\")\n",
        "with open(tokenizer_path, \"wb\") as f:\n",
        "    pickle.dump(tokenizer, f)\n",
        "\n",
        "# Upload model and tokenizer to Hugging Face\n",
        "repo_id = f\"eagle0504/{repo_name}\"  # Change as needed\n",
        "api = HfApi()\n",
        "\n",
        "api.upload_file(path_or_fileobj=model_path, path_in_repo=\"model.keras\", repo_id=repo_id)\n",
        "api.upload_file(path_or_fileobj=tokenizer_path, path_in_repo=\"tokenizer.pkl\", repo_id=repo_id)\n",
        "\n",
        "print(f\"Model and tokenizer successfully pushed to: https://huggingface.co/{repo_id}\")"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "Rtr2BtibTy0e"
      },
      "source": [
        "## Download Model Artifact from HF"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "Wn0SuQcTQK6F"
      },
      "outputs": [],
      "source": [
        "import os\n",
        "import numpy as np\n",
        "import tensorflow as tf\n",
        "from tensorflow import keras\n",
        "from huggingface_hub import hf_hub_download\n",
        "\n",
        "# Set Keras backend to JAX (Optional, only needed if you want to experiment with JAX backend)\n",
        "os.environ[\"KERAS_BACKEND\"] = \"jax\"\n",
        "\n",
        "# Define repo ID and model filename\n",
        "# repo_id = \"eagle0504/my-tf-nn-model\" # we already defined it above\n",
        "filename = \"model.keras\"  # Ensure this matches what was uploaded\n",
        "\n",
        "# Download the model\n",
        "model_path = hf_hub_download(repo_id=repo_id, filename=filename)\n",
        "\n",
        "# Load the Keras model\n",
        "new_model = keras.models.load_model(model_path)\n",
        "\n",
        "print(\"Model loaded successfully!\")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "gYXHAb6QWhNp"
      },
      "outputs": [],
      "source": [
        "new_model.summary()"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "rs6qIIMwT1bt"
      },
      "source": [
        "## Local Inference"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "VHcw9ZUlRzO7"
      },
      "outputs": [],
      "source": [
        "import pickle\n",
        "from huggingface_hub import hf_hub_download\n",
        "from tensorflow import keras\n",
        "from tensorflow.keras.preprocessing.sequence import pad_sequences\n",
        "import numpy as np\n",
        "\n",
        "# Define repo details\n",
        "# repo_id = \"eagle0504/my-tf-nn-model\" # we already defined above\n",
        "\n",
        "# Download model\n",
        "# model_path = hf_hub_download(repo_id=repo_id, filename=\"model.keras\")\n",
        "# new_model = keras.models.load_model(model_path)\n",
        "\n",
        "# Download tokenizer\n",
        "tokenizer_path = hf_hub_download(repo_id=repo_id, filename=\"tokenizer.pkl\")\n",
        "\n",
        "# Load the tokenizer\n",
        "with open(tokenizer_path, \"rb\") as f:\n",
        "    tokenizer = pickle.load(f)\n",
        "\n",
        "print(\"Model and tokenizer loaded successfully!\")\n",
        "\n",
        "# Sample test data\n",
        "test_texts = [\n",
        "    \"How to improve focus and concentration?\",\n",
        "    \"What are the side effects of lack of sleep?\",\n",
        "]\n",
        "\n",
        "# Preprocess test data using the loaded tokenizer\n",
        "max_length = model.input_shape[0][1]  # Get max_length from model input shape\n",
        "X_text_test = tokenizer.texts_to_sequences(test_texts)\n",
        "X_text_test = pad_sequences(X_text_test, maxlen=max_length, padding='post')\n",
        "\n",
        "# Dummy numeric input (func_rating)\n",
        "X_func_test = np.array([5, 4]).reshape(-1, 1)\n",
        "\n",
        "# Make predictions\n",
        "predictions = new_model.predict({\"text_input\": X_text_test, \"func_rating_input\": X_func_test})\n",
        "\n",
        "# Display results\n",
        "for i, text in enumerate(test_texts):\n",
        "    print(f\"Prompt: {text}\")\n",
        "    print(f\"Predicted Rating: {predictions[i][0]:.2f}\")\n",
        "    print(\"-\" * 50)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "evxMdlLY6wQu"
      },
      "outputs": [],
      "source": []
    }
  ],
  "metadata": {
    "accelerator": "GPU",
    "colab": {
      "gpuType": "T4",
      "machine_shape": "hm",
      "provenance": []
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "name": "python"
    },
    "widgets": {
      "application/vnd.jupyter.widget-state+json": {
        "e186266aafe04a6dbf1f61bea7a968e0": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_1bfcd41a70194908b7022f575521d3a9",
              "IPY_MODEL_4d57528b45154030bcac2c0fbae9f7b1",
              "IPY_MODEL_3a1894afc0be49eb9779463c1a597346"
            ],
            "layout": "IPY_MODEL_07bf14be46074e99a98d5560dad1b498"
          }
        },
        "1bfcd41a70194908b7022f575521d3a9": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_851de16ab61349d5892e639154e8c517",
            "placeholder": "",
            "style": "IPY_MODEL_34168978d0774ca688ed5df3f20762f7",
            "value": "tokenizer_config.json:100%"
          }
        },
        "4d57528b45154030bcac2c0fbae9f7b1": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_7a372da2a44943a8adbdc362f436b406",
            "max": 48,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_cc951c80abf24eaaaeec85da75510b61",
            "value": 48
          }
        },
        "3a1894afc0be49eb9779463c1a597346": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_5ff94fb200f6492cbdad767a0198a8dd",
            "placeholder": "",
            "style": "IPY_MODEL_6790398a554e4dc7b2dfd81df0117977",
            "value": "48.0/48.0[00:00&lt;00:00,2.79kB/s]"
          }
        },
        "07bf14be46074e99a98d5560dad1b498": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "851de16ab61349d5892e639154e8c517": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "34168978d0774ca688ed5df3f20762f7": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "7a372da2a44943a8adbdc362f436b406": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "cc951c80abf24eaaaeec85da75510b61": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "5ff94fb200f6492cbdad767a0198a8dd": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "6790398a554e4dc7b2dfd81df0117977": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "034d8e7c165f4c81b9ba2bf775cf9bd6": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_e67251b40cff4b13a6c50bcd72de3bb9",
              "IPY_MODEL_af6d5bc305cd40b1b44b0eed48a376ba",
              "IPY_MODEL_abd1f752d3964adda85a58824df09c41"
            ],
            "layout": "IPY_MODEL_04965b9c9b9b49a1a836117e7ba46b30"
          }
        },
        "e67251b40cff4b13a6c50bcd72de3bb9": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_f0f911ce2456490b965bdb1cb0647c21",
            "placeholder": "",
            "style": "IPY_MODEL_59688b76a2874520be896e685840cd36",
            "value": "vocab.txt:100%"
          }
        },
        "af6d5bc305cd40b1b44b0eed48a376ba": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_cdd2c12a74dd436197762c783233a9e2",
            "max": 231508,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_24697ad8cd644e76942a6e00ec72f7a2",
            "value": 231508
          }
        },
        "abd1f752d3964adda85a58824df09c41": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_477060f80c534b3196b7c83e9d51a0a9",
            "placeholder": "",
            "style": "IPY_MODEL_b7859de3a5284557b01cc4b74b57fcfe",
            "value": "232k/232k[00:00&lt;00:00,1.08MB/s]"
          }
        },
        "04965b9c9b9b49a1a836117e7ba46b30": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "f0f911ce2456490b965bdb1cb0647c21": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "59688b76a2874520be896e685840cd36": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "cdd2c12a74dd436197762c783233a9e2": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "24697ad8cd644e76942a6e00ec72f7a2": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "477060f80c534b3196b7c83e9d51a0a9": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "b7859de3a5284557b01cc4b74b57fcfe": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "167d36e8c7794f35939a8769311b3b9b": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_4d0e190ab5634eecac147bd0868cc23b",
              "IPY_MODEL_a325244b644c4417a1f03ba8a7a93dcf",
              "IPY_MODEL_87c7bb952db743179aecaee43da95b4f"
            ],
            "layout": "IPY_MODEL_4ba63661ba7d4ab69b5b528ba6d04ad1"
          }
        },
        "4d0e190ab5634eecac147bd0868cc23b": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_68f996dd375341a79afe301580a7e90f",
            "placeholder": "",
            "style": "IPY_MODEL_28df4e3cc1524c3a8dc0bdd0e146bdc9",
            "value": "tokenizer.json:100%"
          }
        },
        "a325244b644c4417a1f03ba8a7a93dcf": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_b1edb36e958c4a30922a4ddf30f206a5",
            "max": 466062,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_5db6fbb88195480d965e6ae4172ac7e0",
            "value": 466062
          }
        },
        "87c7bb952db743179aecaee43da95b4f": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_aefe0dc3831b428d8f7038aa079cef6a",
            "placeholder": "",
            "style": "IPY_MODEL_85b9d14eb45343269196336a3ed2d304",
            "value": "466k/466k[00:00&lt;00:00,2.11MB/s]"
          }
        },
        "4ba63661ba7d4ab69b5b528ba6d04ad1": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "68f996dd375341a79afe301580a7e90f": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "28df4e3cc1524c3a8dc0bdd0e146bdc9": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "b1edb36e958c4a30922a4ddf30f206a5": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "5db6fbb88195480d965e6ae4172ac7e0": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "aefe0dc3831b428d8f7038aa079cef6a": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "85b9d14eb45343269196336a3ed2d304": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "eb2f380189134622b085971c5ed36849": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HBoxModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HBoxModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HBoxView",
            "box_style": "",
            "children": [
              "IPY_MODEL_1538646a0d1540f999e08af770c11800",
              "IPY_MODEL_0b899d93e257476b9f908469a91a682e",
              "IPY_MODEL_999f56797bab4fde968cecf4117d4772"
            ],
            "layout": "IPY_MODEL_f79f971ec1b145d89bae555ed5f12998"
          }
        },
        "1538646a0d1540f999e08af770c11800": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_52fc71a0047843eb88cacb3bfd949e14",
            "placeholder": "",
            "style": "IPY_MODEL_38f6a7143a7a476383adc486a6cf6dc1",
            "value": "config.json:100%"
          }
        },
        "0b899d93e257476b9f908469a91a682e": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "FloatProgressModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "FloatProgressModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "ProgressView",
            "bar_style": "success",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_fb3ba6ff04ca41d49bd5d1deae03f01d",
            "max": 570,
            "min": 0,
            "orientation": "horizontal",
            "style": "IPY_MODEL_d6a24cb4eb924af09ceb4751e22057c4",
            "value": 570
          }
        },
        "999f56797bab4fde968cecf4117d4772": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "HTMLModel",
          "model_module_version": "1.5.0",
          "state": {
            "_dom_classes": [],
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "HTMLModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/controls",
            "_view_module_version": "1.5.0",
            "_view_name": "HTMLView",
            "description": "",
            "description_tooltip": null,
            "layout": "IPY_MODEL_6280188efb824ee2a5828638691cc7c2",
            "placeholder": "",
            "style": "IPY_MODEL_5c0021bd6b504caa85791e88eee729cd",
            "value": "570/570[00:00&lt;00:00,55.7kB/s]"
          }
        },
        "f79f971ec1b145d89bae555ed5f12998": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "52fc71a0047843eb88cacb3bfd949e14": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "38f6a7143a7a476383adc486a6cf6dc1": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        },
        "fb3ba6ff04ca41d49bd5d1deae03f01d": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "d6a24cb4eb924af09ceb4751e22057c4": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "ProgressStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "ProgressStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "bar_color": null,
            "description_width": ""
          }
        },
        "6280188efb824ee2a5828638691cc7c2": {
          "model_module": "@jupyter-widgets/base",
          "model_name": "LayoutModel",
          "model_module_version": "1.2.0",
          "state": {
            "_model_module": "@jupyter-widgets/base",
            "_model_module_version": "1.2.0",
            "_model_name": "LayoutModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "LayoutView",
            "align_content": null,
            "align_items": null,
            "align_self": null,
            "border": null,
            "bottom": null,
            "display": null,
            "flex": null,
            "flex_flow": null,
            "grid_area": null,
            "grid_auto_columns": null,
            "grid_auto_flow": null,
            "grid_auto_rows": null,
            "grid_column": null,
            "grid_gap": null,
            "grid_row": null,
            "grid_template_areas": null,
            "grid_template_columns": null,
            "grid_template_rows": null,
            "height": null,
            "justify_content": null,
            "justify_items": null,
            "left": null,
            "margin": null,
            "max_height": null,
            "max_width": null,
            "min_height": null,
            "min_width": null,
            "object_fit": null,
            "object_position": null,
            "order": null,
            "overflow": null,
            "overflow_x": null,
            "overflow_y": null,
            "padding": null,
            "right": null,
            "top": null,
            "visibility": null,
            "width": null
          }
        },
        "5c0021bd6b504caa85791e88eee729cd": {
          "model_module": "@jupyter-widgets/controls",
          "model_name": "DescriptionStyleModel",
          "model_module_version": "1.5.0",
          "state": {
            "_model_module": "@jupyter-widgets/controls",
            "_model_module_version": "1.5.0",
            "_model_name": "DescriptionStyleModel",
            "_view_count": null,
            "_view_module": "@jupyter-widgets/base",
            "_view_module_version": "1.2.0",
            "_view_name": "StyleView",
            "description_width": ""
          }
        }
      }
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}
